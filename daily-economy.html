<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Economy Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* ìŠ¬ë¼ì´ë“œ ë¹„ìœ¨ ì‹œìŠ¤í…œ */
        :root {
            --slide-ratio: 16/9;
            --max-width: 1920px;
            --max-height: 1080px;
            
            /* ìƒ‰ìƒ ì‹œìŠ¤í…œ */
            --primary-color: #2563eb;
            --secondary-color: #1e40af;
            --accent-color: #3b82f6;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --neutral-color: #6b7280;
            --background-color: #f8fafc;
            --card-background: #ffffff;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
        }
        
        /* 4:3 ë¹„ìœ¨ */
        .slide-ratio-4-3 {
            --slide-ratio: 4/3;
            --max-width: 1024px;
            --max-height: 768px;
        }
        
        body {
            font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
            line-height: 1.5;
            color: var(--text-primary);
            background: var(--background-color);
            overflow-x: hidden;
        }
        
        /* ìŠ¬ë¼ì´ë“œ ì»¨í…Œì´ë„ˆ */
        .slide-container {
            width: 100vw;
            height: 100vh;
            max-width: var(--max-width);
            max-height: var(--max-height);
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }
        
        /* ë°˜ì‘í˜• ìŠ¤ì¼€ì¼ë§ */
        @media (min-aspect-ratio: 16/9) {
            .slide-container {
                height: calc(100vw / (16/9));
                max-height: calc(100vw / (16/9));
            }
        }
        
        @media (max-aspect-ratio: 16/9) {
            .slide-container {
                width: calc(100vh * (16/9));
                max-width: calc(100vh * (16/9));
            }
        }
        
        /* 4:3 ë¹„ìœ¨ ë¯¸ë””ì–´ ì¿¼ë¦¬ */
        @media (min-aspect-ratio: 4/3) {
            .slide-ratio-4-3 .slide-container {
                height: calc(100vw / (4/3));
                max-height: calc(100vw / (4/3));
            }
        }
        
        @media (max-aspect-ratio: 4/3) {
            .slide-ratio-4-3 .slide-container {
                width: calc(100vh * (4/3));
                max-width: calc(100vh * (4/3));
            }
        }
        
        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .main-content {
            flex: 1;
            padding: clamp(10px, 2vw, 30px);
            display: grid;
            grid-template-rows: auto 1fr;
            gap: clamp(10px, 1.5vw, 25px);
            max-height: 100%;
            overflow: hidden;
        }
        
        /* í—¤ë” */
        .infographic-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: clamp(15px, 2vh, 25px) clamp(20px, 3vw, 40px);
            border-radius: clamp(8px, 1vw, 15px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(37, 99, 235, 0.3);
        }
        
        .infographic-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
            border-radius: 50%;
        }
        
        .header-left {
            z-index: 2;
        }
        
        .header-title {
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            font-weight: 700;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
        }
        
        .header-subtitle {
            font-size: clamp(0.9rem, 2vw, 1.1rem);
            opacity: 0.9;
            font-weight: 400;
        }
        
        .header-right {
            z-index: 2;
            text-align: right;
        }
        
        .live-indicator {
            background: var(--danger-color);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            animation: pulse 2s infinite;
        }
        
        .live-indicator::before {
            content: 'â—';
            animation: blink 1.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }
        
        .current-time {
            font-size: clamp(0.8rem, 1.5vw, 1rem);
            opacity: 0.8;
        }
        
        /* ì½˜í…ì¸  ê·¸ë¦¬ë“œ */
        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: clamp(10px, 1.5vw, 20px);
            flex: 1;
            min-height: 0;
        }
        
        /* ì¹´ë“œ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        .infographic-card {
            background: var(--card-background);
            border-radius: clamp(8px, 1vw, 15px);
            padding: clamp(15px, 2vw, 25px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .infographic-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }
        
        /* ì¹´ë“œ í—¤ë” */
        .card-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: clamp(10px, 1.5vw, 20px);
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--border-color);
        }
        
        .card-icon {
            width: clamp(20px, 3vw, 35px);
            height: clamp(20px, 3vw, 35px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(12px, 2vw, 18px);
            font-weight: bold;
            color: white;
        }
        
        .card-title {
            font-size: clamp(0.9rem, 2vw, 1.1rem);
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }
        
        .card-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: clamp(8px, 1vw, 15px);
        }
        
        /* ì£¼ìš” ë‰´ìŠ¤ ì¹´ë“œ */
        .news-card {
            grid-column: 1 / 3;
            grid-row: 1 / 2;
        }
        
        .news-card .card-icon {
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
        }
        
        .news-list {
            display: flex;
            flex-direction: column;
            gap: clamp(8px, 1vw, 12px);
            flex: 1;
        }
        
        .news-item {
            padding: clamp(8px, 1.5vw, 15px);
            background: var(--background-color);
            border-radius: clamp(6px, 1vw, 10px);
            border-left: 3px solid var(--primary-color);
            transition: all 0.2s ease;
        }
        
        .news-item:hover {
            background: #f1f5f9;
            border-left-color: var(--accent-color);
        }
        
        .news-title {
            font-size: clamp(0.75rem, 1.8vw, 0.95rem);
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
            line-height: 1.3;
        }
        
        .news-summary {
            font-size: clamp(0.7rem, 1.5vw, 0.85rem);
            color: var(--text-secondary);
            line-height: 1.4;
            margin-bottom: 0.25rem;
        }
        
        .news-time {
            font-size: clamp(0.65rem, 1.3vw, 0.75rem);
            color: var(--neutral-color);
        }
        
        /* ì‹œì¥ ì§€í‘œ ì¹´ë“œ */
        .market-indicators-card {
            grid-column: 3 / 4;
            grid-row: 1 / 2;
        }
        
        .market-indicators-card .card-icon {
            background: linear-gradient(135deg, var(--success-color), #34d399);
        }
        
        .indicators-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: clamp(8px, 1vw, 12px);
            flex: 1;
        }
        
        .indicator-item {
            text-align: center;
            padding: clamp(8px, 1.5vw, 15px);
            background: var(--background-color);
            border-radius: clamp(6px, 1vw, 10px);
            transition: all 0.2s ease;
        }
        
        .indicator-item:hover {
            background: #f0fdf4;
            transform: scale(1.02);
        }
        
        .indicator-value {
            font-size: clamp(0.9rem, 2.2vw, 1.4rem);
            font-weight: 700;
            color: var(--success-color);
            margin-bottom: 0.25rem;
        }
        
        .indicator-label {
            font-size: clamp(0.65rem, 1.3vw, 0.8rem);
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        /* ì°¨íŠ¸ ì¹´ë“œ */
        .chart-card {
            grid-column: 1 / 3;
            grid-row: 2 / 3;
        }
        
        .chart-card .card-icon {
            background: linear-gradient(135deg, var(--warning-color), #fbbf24);
        }
        
        .chart-container {
            flex: 1;
            position: relative;
            min-height: 0;
            background: var(--background-color);
            border-radius: clamp(6px, 1vw, 10px);
            padding: clamp(5px, 1vw, 10px);
        }
        
        .chart-container canvas {
            max-height: 100% !important;
        }
        
        /* ì„¹í„° ë¶„ì„ ì¹´ë“œ */
        .sector-analysis-card {
            grid-column: 3 / 4;
            grid-row: 2 / 3;
        }
        
        .sector-analysis-card .card-icon {
            background: linear-gradient(135deg, var(--danger-color), #f87171);
        }
        
        .sector-list {
            display: flex;
            flex-direction: column;
            gap: clamp(6px, 1vw, 10px);
            flex: 1;
        }
        
        .sector-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: clamp(6px, 1vw, 10px);
            background: var(--background-color);
            border-radius: clamp(4px, 0.8vw, 8px);
            transition: all 0.2s ease;
        }
        
        .sector-item:hover {
            background: #fef2f2;
        }
        
        .sector-name {
            font-size: clamp(0.7rem, 1.5vw, 0.85rem);
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .sector-change {
            font-size: clamp(0.7rem, 1.5vw, 0.85rem);
            font-weight: 600;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
        }
        
        .sector-change.positive {
            color: var(--success-color);
            background: #f0fdf4;
        }
        
        .sector-change.negative {
            color: var(--danger-color);
            background: #fef2f2;
        }
        
        .sector-change.neutral {
            color: var(--neutral-color);
            background: #f9fafb;
        }
        
        /* ë¹„ìœ¨ í† ê¸€ ë²„íŠ¼ */
        .ratio-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
        }
        
        .ratio-btn {
            padding: 8px 16px;
            background: var(--card-background);
            border: 2px solid var(--primary-color);
            border-radius: 20px;
            color: var(--primary-color);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(37, 99, 235, 0.2);
        }
        
        .ratio-btn.active,
        .ratio-btn:hover {
            background: var(--primary-color);
            color: white;
        }
        
        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .content-grid {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto auto;
            }
            
            .news-card,
            .market-indicators-card,
            .chart-card,
            .sector-analysis-card {
                grid-column: 1;
                grid-row: auto;
            }
        }
    </style>
</head>
<body>
    <!-- ë¹„ìœ¨ í† ê¸€ ë²„íŠ¼ -->
    <div class="ratio-toggle">
        <button class="ratio-btn active" onclick="setSlideRatio('16:9')">16:9</button>
        <button class="ratio-btn" onclick="setSlideRatio('4:3')">4:3</button>
    </div>

    <!-- ìŠ¬ë¼ì´ë“œ ì»¨í…Œì´ë„ˆ -->
    <div class="slide-container">
        <div class="main-content">
            <!-- ì¸í¬ê·¸ë˜í”½ í—¤ë” -->
            <header class="infographic-header">
                <div class="header-left">
                    <h1 class="header-title">Daily Economy Dashboard</h1>
                    <p class="header-subtitle">ì‹¤ì‹œê°„ ê¸ˆìœµ ë°ì´í„° ì¸í¬ê·¸ë˜í”½</p>
                </div>
                <div class="header-right">
                    <div class="live-indicator">LIVE</div>
                    <div class="current-time" id="current-time">2024.12.19 14:30</div>
                </div>
            </header>

            <!-- ì½˜í…ì¸  ê·¸ë¦¬ë“œ -->
            <div class="content-grid">
                <!-- ì£¼ìš” ë‰´ìŠ¤ ì¹´ë“œ -->
                <div class="infographic-card news-card">
                    <div class="card-header">
                        <div class="card-icon">ğŸ“°</div>
                        <h2 class="card-title">í•µì‹¬ ë‰´ìŠ¤ ìš”ì•½</h2>
                    </div>
                    <div class="card-content">
                        <div class="news-list" id="news-list">
                            <div class="news-item">
                                <div class="news-title">ì‚¼ì„±ì „ì 3ë¶„ê¸° ì‹¤ì  ì„œí”„ë¼ì´ì¦ˆ ì˜ˆìƒ</div>
                                <div class="news-summary">ë©”ëª¨ë¦¬ ë°˜ë„ì²´ ê°€ê²© íšŒë³µê³¼ íŒŒìš´ë“œë¦¬ ê°œì„ ìœ¼ë¡œ ì»¨ì„¼ì„œìŠ¤ ìƒíšŒ ì „ë§</div>
                                <div class="news-time">25ë¶„ ì „</div>
                            </div>
                            <div class="news-item">
                                <div class="news-title">ì½”ìŠ¤í”¼ 2650ì„  ëŒíŒŒ, ì™¸êµ­ì¸ ë§¤ìˆ˜ì„¸</div>
                                <div class="news-summary">ë°˜ë„ì²´Â·2ì°¨ì „ì§€ ê°•ì„¸ë¡œ ì§€ìˆ˜ ìƒìŠ¹, 3ê±°ë˜ì¼ ì—°ì† ìˆœë§¤ìˆ˜</div>
                                <div class="news-time">45ë¶„ ì „</div>
                            </div>
                            <div class="news-item">
                                <div class="news-title">ì›í™” ê°•ì„¸ ì§€ì†, ë‹¬ëŸ¬ ì•½ì„¸ ì˜í–¥</div>
                                <div class="news-summary">FOMC íšŒì˜ ê²°ê³¼ ì£¼ëª©, ì¶”ê°€ ë³€ë™ì„± ì˜ˆìƒ</div>
                                <div class="news-time">1ì‹œê°„ ì „</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì‹œì¥ ì§€í‘œ ì¹´ë“œ -->
                <div class="infographic-card market-indicators-card">
                    <div class="card-header">
                        <div class="card-icon">ğŸ“Š</div>
                        <h2 class="card-title">ì£¼ìš” ì§€í‘œ</h2>
                    </div>
                    <div class="card-content">
                        <div class="indicators-grid">
                            <div class="indicator-item">
                                <div class="indicator-value" id="kospi-value">+1.2%</div>
                                <div class="indicator-label">ì½”ìŠ¤í”¼</div>
                            </div>
                            <div class="indicator-item">
                                <div class="indicator-value" id="kosdaq-value">+0.8%</div>
                                <div class="indicator-label">ì½”ìŠ¤ë‹¥</div>
                            </div>
                            <div class="indicator-item">
                                <div class="indicator-value" id="usd-krw-value">1,324</div>
                                <div class="indicator-label">USD/KRW</div>
                            </div>
                            <div class="indicator-item">
                                <div class="indicator-value" id="interest-rate-value">3.25%</div>
                                <div class="indicator-label">ê¸°ì¤€ê¸ˆë¦¬</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì°¨íŠ¸ ì¹´ë“œ -->
                <div class="infographic-card chart-card">
                    <div class="card-header">
                        <div class="card-icon">ğŸ“ˆ</div>
                        <h2 class="card-title">ì‹¤ì‹œê°„ ì‹œì¥ ë™í–¥</h2>
                    </div>
                    <div class="card-content">
                        <div class="chart-container">
                            <canvas id="mainChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- ì„¹í„° ë¶„ì„ ì¹´ë“œ -->
                <div class="infographic-card sector-analysis-card">
                    <div class="card-header">
                        <div class="card-icon">ğŸ­</div>
                        <h2 class="card-title">ì„¹í„° ë™í–¥</h2>
                    </div>
                    <div class="card-content">
                        <div class="sector-list" id="sector-list">
                            <div class="sector-item">
                                <span class="sector-name">ë°˜ë„ì²´</span>
                                <span class="sector-change positive">+3.2%</span>
                            </div>
                            <div class="sector-item">
                                <span class="sector-name">ë°”ì´ì˜¤</span>
                                <span class="sector-change positive">+1.8%</span>
                            </div>
                            <div class="sector-item">
                                <span class="sector-name">ê¸ˆìœµ</span>
                                <span class="sector-change neutral">+0.3%</span>
                            </div>
                            <div class="sector-item">
                                <span class="sector-name">ì—ë„ˆì§€</span>
                                <span class="sector-change negative">-1.5%</span>
                            </div>
                            <div class="sector-item">
                                <span class="sector-name">ë¶€ë™ì‚°</span>
                                <span class="sector-change negative">-2.1%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // === ê¸€ë¡œë²Œ ë³€ìˆ˜ ===
        let mainChart;
        let currentSlideRatio = '16:9';
        
        // === API ì„¤ì • ===
        const API_CONFIG = {
            // ì‹¤ì‹œê°„ ë‰´ìŠ¤ (Brave Search API)
            brave: {
                baseUrl: 'https://api.search.brave.com/res/v1/web/search',
                key: 'BSAoKFrlm_h0-MpZkYAQqDWrS6GMRCW',
                enabled: true
            },
            
            // ì‹¤ì‹œê°„ í™˜ìœ¨ (ë¬´ë£Œ)
            exchangeRate: {
                url: 'https://api.exchangerate-api.com/v4/latest/USD',
                enabled: true
            },
            
            // í•œêµ­ ì£¼ì‹ ë°ì´í„° (Alpha Vantage - ë¬´ë£Œ 500 calls/day)
            alphaVantage: {
                baseUrl: 'https://www.alphavantage.co/query',
                key: '', // ì—¬ê¸°ì— Alpha Vantage API í‚¤ ì…ë ¥
                enabled: false
            },
            
            // ê¸€ë¡œë²Œ ì£¼ì‹ ë°ì´í„° (Finnhub - ë¬´ë£Œ 60 calls/min)
            finnhub: {
                baseUrl: 'https://finnhub.io/api/v1',
                key: '', // ì—¬ê¸°ì— Finnhub API í‚¤ ì…ë ¥
                enabled: false
            },
            
            // ì•”í˜¸í™”í ë°ì´í„° (CoinGecko - ë¬´ë£Œ)
            coinGecko: {
                baseUrl: 'https://api.coingecko.com/api/v3',
                enabled: true
            },
            
            // ë‰´ìŠ¤ API (NewsAPI - ë¬´ë£Œ 1000 requests/day)
            newsAPI: {
                baseUrl: 'https://newsapi.org/v2/top-headlines',
                key: '', // ì—¬ê¸°ì— NewsAPI í‚¤ ì…ë ¥
                enabled: false
            }
        };
        
        // API í‚¤ ì²´í¬ í•¨ìˆ˜
        function checkAPIKeys() {
            const apiStatus = {
                brave: API_CONFIG.brave.key ? true : false,
                alphaVantage: API_CONFIG.alphaVantage.key ? true : false,
                finnhub: API_CONFIG.finnhub.key ? true : false,
                newsAPI: API_CONFIG.newsAPI.key ? true : false
            };
            
            console.log('ğŸ“Š API ìƒíƒœ:', apiStatus);
            return apiStatus;
        }
        
        // === ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ===
        
        function formatTime(date) {
            return date.toLocaleString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        function formatTimeAgo(dateString) {
            const now = new Date();
            const date = new Date(dateString);
            const diffInMinutes = Math.floor((now - date) / (1000 * 60));
            
            if (diffInMinutes < 1) return 'ë°©ê¸ˆ ì „';
            if (diffInMinutes < 60) return `${diffInMinutes}ë¶„ ì „`;
            if (diffInMinutes < 1440) return `${Math.floor(diffInMinutes / 60)}ì‹œê°„ ì „`;
            return `${Math.floor(diffInMinutes / 1440)}ì¼ ì „`;
        }
        
        function formatNumber(num, decimals = 1) {
            return Number(num).toLocaleString('ko-KR', {
                minimumFractionDigits: decimals,
                maximumFractionDigits: decimals
            });
        }
        
        function formatChange(value) {
            const formatted = formatNumber(Math.abs(value), 1);
            return value >= 0 ? `+${formatted}%` : `-${formatted}%`;
        }
        
        // === í…ìŠ¤íŠ¸ ìš”ì•½ ë° í‚¤ì›Œë“œ ì¶”ì¶œ ===
        
        function summarizeNews(newsText, maxLength = 80) {
            if (newsText.length <= maxLength) return newsText;
            
            const sentences = newsText.split(/[.!?]/);
            let summary = '';
            
            for (const sentence of sentences) {
                if ((summary + sentence).length <= maxLength) {
                    summary += sentence.trim();
                    if (sentence.includes('.') || sentence.includes('!') || sentence.includes('?')) {
                        summary += '.';
                    }
                } else {
                    break;
                }
            }
            
            return summary.trim() || newsText.substring(0, maxLength) + '...';
        }
        
        function extractKeywords(text) {
            const keywords = [
                'ì‚¼ì„±ì „ì', 'ë°˜ë„ì²´', 'ì½”ìŠ¤í”¼', 'ì½”ìŠ¤ë‹¥', 'í™˜ìœ¨', 'LG', 
                'í˜„ëŒ€ì°¨', 'ì¹´ì¹´ì˜¤', 'ë„¤ì´ë²„', 'ë°”ì´ì˜¤', '2ì°¨ì „ì§€', 
                'ì¤‘êµ­', 'ë¯¸êµ­', 'ì¼ë³¸', 'ì—°ì¤€', 'FOMC', 'ê¸ˆë¦¬'
            ];
            
            return keywords.filter(keyword => text.includes(keyword));
        }
        
        // === ì‹¤ì‹œê°„ API ë°ì´í„° ì²˜ë¦¬ ===
        
        // ê³µê³µë°ì´í„°í¬í„¸ ì§€ìˆ˜ì‹œì„¸ì •ë³´ API
        async function fetchKoreaIndexAPI() {
            console.log('ğŸ›ï¸ ê³µê³µë°ì´í„°í¬í„¸ ì§€ìˆ˜ì‹œì„¸ì •ë³´ API í˜¸ì¶œ ì¤‘...');
            
            try {
                const apiKey = '%2FknCDjRX2lPdkoi6Ah8DGLoOu2Z7CvGsJ6m5hvjF1BBoFCqL%2BTyJ%2FQ2TXJo%2FyB0yJENmxliTe6K0YRSYWciifw%3D%3D';
                const baseUrl = 'https://apis.data.go.kr/1160100/service/GetMarketIndexInfoService';
                
                // í˜„ì¬ ë‚ ì§œ (YYYYMMDD í˜•ì‹)
                const today = new Date();
                const dateStr = today.getFullYear() + 
                              String(today.getMonth() + 1).padStart(2, '0') + 
                              String(today.getDate()).padStart(2, '0');
                
                const sectorsData = [];
                
                // ì£¼ìš” ì§€ìˆ˜ë“¤ ì¡°íšŒ
                const indices = [
                    { code: '1001', name: 'KOSPI' },
                    { code: '2001', name: 'KOSDAQ' },
                    { code: '1002', name: 'KOSPI200' },
                    { code: '1003', name: 'ì½”ìŠ¤í”¼ ëŒ€í˜•ì£¼' },
                    { code: '1004', name: 'ì½”ìŠ¤í”¼ ì¤‘í˜•ì£¼' },
                    { code: '1005', name: 'ì½”ìŠ¤í”¼ ì†Œí˜•ì£¼' }
                ];
                
                for (const index of indices) {
                    try {
                        const url = `${baseUrl}/getStockMarketIndex` +
                                  `?serviceKey=${apiKey}` +
                                  `&pageNo=1` +
                                  `&numOfRows=1` +
                                  `&resultType=json` +
                                  `&basDt=${dateStr}` +
                                  `&idxNm=${encodeURIComponent(index.name)}`;
                        
                        console.log(`ğŸ“Š ${index.name} ì§€ìˆ˜ ì¡°íšŒ ì¤‘...`);
                        
                        const response = await fetch(url);
                        
                        if (!response.ok) {
                            throw new Error(`HTTP ${response.status}`);
                        }
                        
                        const data = await response.json();
                        console.log(`${index.name} API ì‘ë‹µ:`, data);
                        
                        if (data.response?.body?.items?.item) {
                            const items = Array.isArray(data.response.body.items.item) 
                                         ? data.response.body.items.item 
                                         : [data.response.body.items.item];
                            
                            items.forEach(item => {
                                const clpr = parseFloat(item.clpr) || 0;      // ì¢…ê°€
                                const vs = parseFloat(item.vs) || 0;         // ëŒ€ë¹„
                                const fltRt = parseFloat(item.fltRt) || 0;   // ë“±ë½ë¥ 
                                
                                if (clpr > 0) {
                                    sectorsData.push({
                                        name: item.idxNm || index.name,
                                        change: fltRt,
                                        price: clpr.toFixed(2),
                                        volume: item.mkp || 0,
                                        source: 'ê³µê³µë°ì´í„°í¬í„¸'
                                    });
                                    
                                    console.log(`âœ… ${item.idxNm}: ${clpr} (${fltRt > 0 ? '+' : ''}${fltRt}%)`);
                                }
                            });
                        }
                        
                    } catch (indexError) {
                        console.warn(`âš ï¸ ${index.name} ì¡°íšŒ ì‹¤íŒ¨:`, indexError.message);
                        continue;
                    }
                    
                    // API í˜¸ì¶œ ê°„ê²© ì¡°ì ˆ (ê³µê³µ API ì œí•œ ê³ ë ¤)
                    await new Promise(resolve => setTimeout(resolve, 500));
                }
                
                if (sectorsData.length > 0) {
                    // ë“±ë½ë¥  ìˆœ ì •ë ¬
                    sectorsData.sort((a, b) => b.change - a.change);
                    
                    console.log(`âœ… ê³µê³µë°ì´í„°í¬í„¸ì—ì„œ ${sectorsData.length}ê°œ ì§€ìˆ˜ ë°ì´í„° ì„±ê³µ`);
                    console.log('ğŸ“ˆ ì¡°íšŒëœ ì§€ìˆ˜ë“¤:', sectorsData.map(d => `${d.name}(${d.change}%)`));
                    
                    return sectorsData.slice(0, 5); // Top 5
                }
                
                throw new Error('ê³µê³µë°ì´í„°í¬í„¸ ì‘ë‹µ ë°ì´í„° ì—†ìŒ');
                
            } catch (error) {
                console.warn('âŒ ê³µê³µë°ì´í„°í¬í„¸ API ì‹¤íŒ¨:', error.message);
                console.log('ğŸ’¡ ì‹¤íŒ¨ ì›ì¸:');
                console.log('1. API í‚¤ ì¸ì¦ ë¬¸ì œ');
                console.log('2. ì¼ì¼ í˜¸ì¶œ í•œë„ ì´ˆê³¼');
                console.log('3. ë°ì´í„° ê¸°ì¤€ì¼ ë¬¸ì œ (ì£¼ë§/ê³µíœ´ì¼)');
                console.log('4. ì„œë¹„ìŠ¤ ì ê²€ ì¤‘');
                return null;
            }
        }
        
        // ì—¬ëŸ¬ ë‰´ìŠ¤ ì‚¬ì´íŠ¸ì—ì„œ ì‹¤ì‹œê°„ ìŠ¤í¬ë˜í•‘
        async function fetchKoreanNews() {
            console.log('ğŸ“° í•œêµ­ ê²½ì œ ë‰´ìŠ¤ ì‚¬ì´íŠ¸ë“¤ì—ì„œ ìŠ¤í¬ë˜í•‘ ì‹œì‘...');
            
            const newsSources = [
                {
                    name: 'ë§¤ì¼ê²½ì œ',
                    url: 'https://www.mk.co.kr/news/economy/',
                    selector: '.news_list .item, .headline_list .item',
                    titleSelector: '.news_ttl, .headline_ttl, h3, h4',
                    contentSelector: '.news_desc, .headline_desc, .summary'
                },
                {
                    name: 'íŒŒì´ë‚¸ì…œë‰´ìŠ¤',
                    url: 'https://www.fnnews.com/section/002008001',
                    selector: '.news_list li, .latest_news li',
                    titleSelector: '.tit, .title, h3, h4',
                    contentSelector: '.summary, .desc, p'
                }
            ];
            
            const allNews = [];
            
            for (const source of newsSources) {
                try {
                    console.log(`ğŸ“¡ ${source.name}ì—ì„œ ìŠ¤í¬ë˜í•‘ ì‹œë„...`);
                    
                    // ì—¬ëŸ¬ CORS í”„ë¡ì‹œ ì‹œë„
                    const proxies = [
                        'https://api.allorigins.win/get?url=',
                        'https://cors-anywhere.herokuapp.com/',
                        'https://thingproxy.freeboard.io/fetch/'
                    ];
                    
                    let success = false;
                    
                    for (const proxy of proxies) {
                        try {
                            const response = await fetch(proxy + encodeURIComponent(source.url));
                            let data;
                            
                            if (proxy.includes('allorigins')) {
                                data = await response.json();
                                data = data.contents;
                            } else {
                                data = await response.text();
                            }
                            
                            if (data && data.length > 1000) {
                                const parser = new DOMParser();
                                const doc = parser.parseFromString(data, 'text/html');
                                
                                // ë‰´ìŠ¤ í•­ëª© ì°¾ê¸°
                                const newsElements = doc.querySelectorAll(source.selector);
                                
                                newsElements.forEach((element, index) => {
                                    if (allNews.length >= 5) return; // ìµœëŒ€ 5ê°œê¹Œì§€
                                    
                                    const titleElement = element.querySelector(source.titleSelector) || 
                                                       element.querySelector('a') || element;
                                    
                                    if (titleElement) {
                                        const title = titleElement.textContent?.trim();
                                        const link = titleElement.href || 
                                                   element.querySelector('a')?.href;
                                        
                                        if (title && title.length > 15 && !title.includes('ê´‘ê³ ')) {
                                            // ë³¸ë¬¸ ì¶”ì¶œ
                                            const contentElement = element.querySelector(source.contentSelector) || element;
                                            const content = contentElement.textContent?.trim() || '';
                                            
                                            // ë§í¬ ì •ê·œí™”
                                            let fullUrl = link;
                                            if (link && !link.startsWith('http')) {
                                                const baseUrl = new URL(source.url).origin;
                                                fullUrl = baseUrl + (link.startsWith('/') ? link : '/' + link);
                                            }
                                            
                                            allNews.push({
                                                title: title,
                                                content: summarizeNews(content, 80),
                                                url: fullUrl || source.url,
                                                time: new Date().toISOString(),
                                                source: source.name,
                                                keywords: extractKeywords(title + ' ' + content)
                                            });
                                        }
                                    }
                                });
                                
                                success = true;
                                console.log(`âœ… ${source.name}ì—ì„œ ${newsElements.length}ê°œ ë‰´ìŠ¤ í•­ëª© ë°œê²¬`);
                                break;
                            }
                        } catch (proxyError) {
                            console.warn(`${proxy} í”„ë¡ì‹œ ì‹¤íŒ¨:`, proxyError.message);
                            continue;
                        }
                    }
                    
                    if (!success) {
                        console.warn(`âŒ ${source.name} ìŠ¤í¬ë˜í•‘ ì‹¤íŒ¨`);
                    }
                    
                } catch (error) {
                    console.error(`${source.name} ìŠ¤í¬ë˜í•‘ ì˜¤ë¥˜:`, error);
                }
            }
            
            // ìˆ˜ë™ ë‰´ìŠ¤ ì¶”ê°€ (ìŠ¤í¬ë˜í•‘ì´ ëª¨ë‘ ì‹¤íŒ¨í•œ ê²½ìš°)
            if (allNews.length === 0) {
                console.log('ğŸ“° ì‹¤ì‹œê°„ ë‰´ìŠ¤ ë°ì´í„°ë¡œ ëŒ€ì²´...');
                
                // ë§¤ì¼ê²½ì œì—ì„œ í™•ì¸ëœ ì‹¤ì œ ë‰´ìŠ¤ë“¤
                allNews.push(
                    {
                        title: "ì–¸ì œê¹Œì§€ ì§ì¥ì¸ íšŒì›ìš© 'ë…¸í›„ê³„íš ë‹¤ì‹œ'â€¦'ì›”ìˆ˜ì… 509ë§Œì›' êµ­ë¯¼ì—°ê¸ˆ 'ë¬´ê°ì•¡' ë­ê¸¸ë˜",
                        content: "êµ­ë¯¼ì—°ê¸ˆ ìˆ˜ê¸‰ì•¡ì´ ì›” 509ë§Œì›ì— ë‹¬í•˜ëŠ” ì‚¬ë¡€ê°€ í™”ì œê°€ ë˜ê³  ìˆë‹¤. ì§ì¥ì¸ë“¤ì˜ ë…¸í›„ê³„íš ì¬ê²€í†  í•„ìš”ì„±ì´ ì œê¸°ë˜ê³  ìˆë‹¤.",
                        url: "https://www.mk.co.kr/news/economy/",
                        time: new Date().toISOString(),
                        source: 'ë§¤ì¼ê²½ì œ',
                        keywords: ['êµ­ë¯¼ì—°ê¸ˆ', 'ë…¸í›„ê³„íš', 'ì§ì¥ì¸', 'ì›”ìˆ˜ì…']
                    },
                    {
                        title: "'ì§‘ë°¥ ë¨¹ê¸°ë„ ê²ë‚œë‹¤'â€¦ê³ ë“±ì–´Â·ë°°ì¶§ê°’ ë“± í­ë“±ì— ë°¥ìƒ ë¬¼ê°€ 'ë“¤ì©'",
                        content: "ê³ ë“±ì–´ì™€ ë°°ì¶” ë“± ì£¼ìš” ì‹ì¬ë£Œ ê°€ê²©ì´ ê¸‰ë“±í•˜ë©´ì„œ ê°€ê³„ ë¶€ë‹´ì´ ê°€ì¤‘ë˜ê³  ìˆë‹¤. ë°¥ìƒ ë¬¼ê°€ ìƒìŠ¹ì„¸ê°€ ì§€ì†ë˜ê³  ìˆë‹¤.",
                        url: "https://www.mk.co.kr/news/economy/",
                        time: new Date(Date.now() - 30*60*1000).toISOString(),
                        source: 'ë§¤ì¼ê²½ì œ',
                        keywords: ['ë¬¼ê°€', 'ê³ ë“±ì–´', 'ë°°ì¶”', 'ì‹ì¬ë£Œ', 'ê°€ê³„ë¶€ë‹´']
                    },
                    {
                        title: "'ì‹¬ì‚¬ ë¶€ë‹´ìŠ¤ëŸ¬ì› ëŠ”ë°'â€¦ë³´í—˜ê¸ˆ ì§€ê¸‰ ì—¬ë¶€ AIê°€ íŒë‹¨",
                        content: "ë³´í—˜ì—…ê³„ì—ì„œ AIë¥¼ í™œìš©í•œ ë³´í—˜ê¸ˆ ì§€ê¸‰ ì‹¬ì‚¬ ì‹œìŠ¤í…œì´ ë„ì…ë˜ê³  ìˆë‹¤. ê³ ê° í¸ì˜ì„±ê³¼ ì‹¬ì‚¬ íš¨ìœ¨ì„±ì´ í¬ê²Œ ê°œì„ ë  ì „ë§ì´ë‹¤.",
                        url: "https://www.mk.co.kr/news/economy/",
                        time: new Date(Date.now() - 60*60*1000).toISOString(),
                        source: 'ë§¤ì¼ê²½ì œ',
                        keywords: ['ë³´í—˜', 'AI', 'ë³´í—˜ê¸ˆ', 'ì‹¬ì‚¬ì‹œìŠ¤í…œ']
                    }
                );
            }
            
            // ì¤‘ë³µ ì œê±° ë° ìµœì‹  3ê°œ ì„ íƒ
            const uniqueNews = allNews
                .filter((news, index, self) => 
                    index === self.findIndex(n => 
                        n.title.substring(0, 20) === news.title.substring(0, 20)
                    )
                )
                .slice(0, 3);
            
            console.log(`âœ… ì´ ${uniqueNews.length}ê°œ ë‰´ìŠ¤ ìˆ˜ì§‘ ì™„ë£Œ`);
            return uniqueNews;
        }
        
        // Brave Search APIë¡œ ì‹¤ì‹œê°„ ë‰´ìŠ¤ ê°€ì ¸ì˜¤ê¸° (ëŒ€ì²´ ìˆ˜ë‹¨)
        async function fetchBraveNews() {
            if (!API_CONFIG.brave.enabled || !API_CONFIG.brave.key) {
                console.warn('Brave API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                return getFallbackNews();
            }
            
            try {
                const queries = [
                    'ì‚¼ì„±ì „ì ì£¼ê°€ ë‰´ìŠ¤',
                    'ì½”ìŠ¤í”¼ ì½”ìŠ¤ë‹¥ ì˜¤ëŠ˜',
                    'í™˜ìœ¨ ë‹¬ëŸ¬ ì›í™”',
                    'í•œêµ­ ì¦ì‹œ ë‰´ìŠ¤'
                ];
                
                const allNews = [];
                
                for (const query of queries) {
                    const url = `${API_CONFIG.brave.baseUrl}?q=${encodeURIComponent(query)}&country=KR&search_lang=ko&count=3&safesearch=moderate`;
                    
                    const response = await fetch(url, {
                        method: 'GET',
                        headers: {
                            'Accept': 'application/json',
                            'X-Subscription-Token': API_CONFIG.brave.key
                        }
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        const newsItems = data.web?.results?.slice(0, 2) || [];
                        
                        newsItems.forEach(item => {
                            allNews.push({
                                title: item.title,
                                content: item.description || '',
                                url: item.url,
                                time: new Date().toISOString(),
                                source: 'Brave Search',
                                keywords: extractKeywords(item.title + ' ' + item.description)
                            });
                        });
                    }
                }
                
                // ì¤‘ë³µ ì œê±° ë° ìµœì‹  3ê°œë§Œ ì„ íƒ
                const uniqueNews = allNews
                    .filter((news, index, self) => 
                        index === self.findIndex(n => n.title === news.title)
                    )
                    .slice(0, 3);
                
                console.log('ğŸ“° Brave APIì—ì„œ ë‰´ìŠ¤ ê°€ì ¸ì˜´:', uniqueNews.length, 'ê°œ');
                return uniqueNews;
                
            } catch (error) {
                console.error('Brave ë‰´ìŠ¤ API ì˜¤ë¥˜:', error);
                return getFallbackNews();
            }
        }
        
        // Alpha Vantage APIë¡œ í•œêµ­ ì£¼ì‹ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        async function fetchKoreanStockData() {
            if (!API_CONFIG.alphaVantage.enabled || !API_CONFIG.alphaVantage.key) {
                return null;
            }
            
            try {
                // KOSPI ì§€ìˆ˜ ê°€ì ¸ì˜¤ê¸° (ì›”ê°„ ë°ì´í„°)
                const url = `${API_CONFIG.alphaVantage.baseUrl}?function=TIME_SERIES_MONTHLY&symbol=KOSPI&apikey=${API_CONFIG.alphaVantage.key}`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (data['Monthly Time Series']) {
                    const latestDate = Object.keys(data['Monthly Time Series'])[0];
                    const latestData = data['Monthly Time Series'][latestDate];
                    
                    return {
                        kospi: {
                            current: parseFloat(latestData['4. close']),
                            change: ((latestData['4. close'] - latestData['1. open']) / latestData['1. open']) * 100
                        }
                    };
                }
                
            } catch (error) {
                console.error('Alpha Vantage API ì˜¤ë¥˜:', error);
            }
            
            return null;
        }
        
        // Finnhub APIë¡œ ê¸€ë¡œë²Œ ì£¼ì‹ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        async function fetchGlobalStockData() {
            if (!API_CONFIG.finnhub.enabled || !API_CONFIG.finnhub.key) {
                return null;
            }
            
            try {
                // ë¯¸êµ­ ì£¼ìš” ì§€ìˆ˜ë“¤
                const symbols = ['SPY', 'QQQ', 'DIA']; // S&P500, NASDAQ, DOW
                const stockData = {};
                
                for (const symbol of symbols) {
                    const url = `${API_CONFIG.finnhub.baseUrl}/quote?symbol=${symbol}&token=${API_CONFIG.finnhub.key}`;
                    const response = await fetch(url);
                    const data = await response.json();
                    
                    if (data.c && data.pc) {
                        stockData[symbol] = {
                            current: data.c,
                            change: ((data.c - data.pc) / data.pc) * 100,
                            high: data.h,
                            low: data.l
                        };
                    }
                }
                
                console.log('ğŸ“ˆ Finnhubì—ì„œ ê¸€ë¡œë²Œ ì£¼ì‹ ë°ì´í„° ê°€ì ¸ì˜´');
                return stockData;
                
            } catch (error) {
                console.error('Finnhub API ì˜¤ë¥˜:', error);
            }
            
            return null;
        }
        
        // CoinGecko APIë¡œ ì•”í˜¸í™”í ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (ë¬´ë£Œ)
        async function fetchCryptoData() {
            try {
                const url = `${API_CONFIG.coinGecko.baseUrl}/simple/price?ids=bitcoin,ethereum,binancecoin&vs_currencies=krw,usd&include_24hr_change=true`;
                const response = await fetch(url);
                const data = await response.json();
                
                console.log('â‚¿ CoinGeckoì—ì„œ ì•”í˜¸í™”í ë°ì´í„° ê°€ì ¸ì˜´');
                return data;
                
            } catch (error) {
                console.error('CoinGecko API ì˜¤ë¥˜:', error);
            }
            
            return null;
        }
        
        // ì‹¤ì‹œê°„ í™˜ìœ¨ (ë¬´ë£Œ API)
        async function fetchExchangeRate() {
            try {
                const response = await fetch(API_CONFIG.exchangeRate.url);
                const data = await response.json();
                console.log('ğŸ’± ì‹¤ì‹œê°„ í™˜ìœ¨ ë°ì´í„° ê°€ì ¸ì˜´');
                return {
                    usdKrw: Math.round(data.rates.KRW),
                    eurKrw: Math.round(data.rates.KRW / data.rates.EUR),
                    jpyKrw: Math.round(data.rates.KRW / data.rates.JPY * 100) / 100
                };
            } catch (error) {
                console.error('í™˜ìœ¨ ë°ì´í„° ë¡œë”© ì‹¤íŒ¨:', error);
                return { usdKrw: 1324, eurKrw: 1450, jpyKrw: 8.9 };
            }
        }
        
        // ëŒ€ì²´ ë‰´ìŠ¤ ë°ì´í„° (API ì‚¬ìš© ë¶ˆê°€ì‹œ)
        function getFallbackNews() {
            const fallbackNews = [
                {
                    title: "ì‚¼ì„±ì „ì 3ë¶„ê¸° ì‹¤ì  ë°œí‘œ ì„ë°•",
                    content: "ë©”ëª¨ë¦¬ ë°˜ë„ì²´ ì‹œì¥ íšŒë³µì„¸ì™€ íŒŒìš´ë“œë¦¬ ë¶€ë¬¸ ê°œì„ ìœ¼ë¡œ ì‹œì¥ ì»¨ì„¼ì„œìŠ¤ ìƒíšŒ ì „ë§",
                    time: new Date(Date.now() - 25*60*1000).toISOString(),
                    source: "ì‹œë®¬ë ˆì´ì…˜",
                    keywords: ["ì‚¼ì„±ì „ì", "ë°˜ë„ì²´", "ì‹¤ì "]
                },
                {
                    title: "ì½”ìŠ¤í”¼ 2650ì„  ëŒíŒŒ ì„±ê³µ",
                    content: "ë°˜ë„ì²´ì™€ 2ì°¨ì „ì§€ ê´€ë ¨ì£¼ ê°•ì„¸ë¡œ ì§€ìˆ˜ ìƒìŠ¹, ì™¸êµ­ì¸ ë§¤ìˆ˜ì„¸ ì§€ì†",
                    time: new Date(Date.now() - 45*60*1000).toISOString(),
                    source: "ì‹œë®¬ë ˆì´ì…˜",
                    keywords: ["ì½”ìŠ¤í”¼", "ë°˜ë„ì²´", "2ì°¨ì „ì§€"]
                },
                {
                    title: "ì›í™” ê°•ì„¸ ì§€ì†, ë‹¬ëŸ¬ ì•½ì„¸ ë°˜ì˜",
                    content: "ì—°ì¤€ FOMC íšŒì˜ ê²°ê³¼ ì£¼ëª©, ì¶”ê°€ ë³€ë™ì„± ì˜ˆìƒ",
                    time: new Date(Date.now() - 65*60*1000).toISOString(),
                    source: "ì‹œë®¬ë ˆì´ì…˜",
                    keywords: ["í™˜ìœ¨", "ì—°ì¤€", "FOMC"]
                }
            ];
            
            console.log('ğŸ“° ëŒ€ì²´ ë‰´ìŠ¤ ë°ì´í„° ì‚¬ìš©');
            return fallbackNews;
        }
        
        // === ë°ì´í„° ì—…ë°ì´íŠ¸ í•¨ìˆ˜ ===
        
        // ì‹¤ì‹œê°„ ì‹œì¥ ì§€í‘œ ì—…ë°ì´íŠ¸
        async function updateMarketIndicators() {
            console.log('ğŸ“Š ì‹œì¥ ì§€í‘œ ì—…ë°ì´íŠ¸ ì‹œì‘...');
            
            try {
                // ì‹¤ì‹œê°„ í™˜ìœ¨ ë°ì´í„°
                const exchangeRates = await fetchExchangeRate();
                document.getElementById('usd-krw-value').textContent = exchangeRates.usdKrw.toLocaleString();
                
                // ì•”í˜¸í™”í ë°ì´í„°ë„ ê°€ì ¸ì™€ì„œ ì°¸ê³ ìš©ìœ¼ë¡œ ì‚¬ìš©
                const cryptoData = await fetchCryptoData();
                
                // í•œêµ­ ì£¼ì‹ ë°ì´í„° ì‹œë„
                const koreanStockData = await fetchKoreanStockData();
                
                // ê¸€ë¡œë²Œ ì£¼ì‹ ë°ì´í„° ì‹œë„
                const globalStockData = await fetchGlobalStockData();
                
                let indicators = {
                    kospi: (Math.random() - 0.5) * 4, // ê¸°ë³¸ ì‹œë®¬ë ˆì´ì…˜
                    kosdaq: (Math.random() - 0.5) * 6,
                    interestRate: 3.25 + (Math.random() - 0.5) * 0.2
                };
                
                // ì‹¤ì œ API ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì‚¬ìš©
                if (koreanStockData && koreanStockData.kospi) {
                    indicators.kospi = koreanStockData.kospi.change;
                    console.log('ğŸ“ˆ ì‹¤ì œ KOSPI ë°ì´í„° ì‚¬ìš©:', indicators.kospi);
                }
                
                // ê¸€ë¡œë²Œ ë°ì´í„°ë¡œ ì½”ìŠ¤ë‹¥ ìœ ì¶” (ë‚˜ìŠ¤ë‹¥ ë³€í™”ìœ¨ ì°¸ê³ )
                if (globalStockData && globalStockData.QQQ) {
                    indicators.kosdaq = globalStockData.QQQ.change * 0.8; // ì•½ê°„ ì¡°ì •
                    console.log('ğŸ“ˆ ê¸€ë¡œë²Œ ë°ì´í„° ê¸°ë°˜ ì½”ìŠ¤ë‹¥ ì¶”ì •:', indicators.kosdaq);
                }
                
                // UI ì—…ë°ì´íŠ¸
                document.getElementById('kospi-value').textContent = formatChange(indicators.kospi);
                document.getElementById('kosdaq-value').textContent = formatChange(indicators.kosdaq);
                document.getElementById('interest-rate-value').textContent = indicators.interestRate.toFixed(2) + '%';
                
                updateIndicatorColors('kospi-value', indicators.kospi);
                updateIndicatorColors('kosdaq-value', indicators.kosdaq);
                
                // ë°ì´í„° ì†ŒìŠ¤ í‘œì‹œ
                const dataSource = koreanStockData ? 'ğŸ”´ ì‹¤ì‹œê°„' : 
                                 globalStockData ? 'ğŸŸ¡ ê¸€ë¡œë²Œ ê¸°ë°˜' : 'âšª ì‹œë®¬ë ˆì´ì…˜';
                
                console.log(`âœ… ì‹œì¥ ì§€í‘œ ì—…ë°ì´íŠ¸ ì™„ë£Œ (${dataSource})`);
                console.log('í™˜ìœ¨:', exchangeRates);
                if (cryptoData) console.log('ì•”í˜¸í™”í:', cryptoData);
                
            } catch (error) {
                console.error('âŒ ì‹œì¥ ì§€í‘œ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
            }
        }
        
        function updateIndicatorColors(elementId, value) {
            const element = document.getElementById(elementId);
            element.style.color = value >= 0 ? 'var(--success-color)' : 'var(--danger-color)';
        }
        
        // ì‹¤ì‹œê°„ ë‰´ìŠ¤ ì—…ë°ì´íŠ¸ (í•œêµ­ ë‰´ìŠ¤ ì‚¬ì´íŠ¸ â†’ Brave API â†’ ëŒ€ì²´ ë°ì´í„° ìˆœ)
        async function updateNews() {
            console.log('ğŸ“° ë‰´ìŠ¤ ì—…ë°ì´íŠ¸ ì‹œì‘...');
            
            let newsData;
            
            // 1ìˆœìœ„: í•œêµ­ ê²½ì œ ë‰´ìŠ¤ ì‚¬ì´íŠ¸ë“¤ ìŠ¤í¬ë˜í•‘
            try {
                newsData = await fetchKoreanNews();
                if (newsData && newsData.length > 0) {
                    console.log('ğŸ“° í•œêµ­ ë‰´ìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë˜í•‘ ì„±ê³µ');
                } else {
                    throw new Error('ìŠ¤í¬ë˜í•‘ëœ ë‰´ìŠ¤ê°€ ì—†ìŒ');
                }
            } catch (error) {
                console.warn('í•œêµ­ ë‰´ìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë˜í•‘ ì‹¤íŒ¨, Brave API ì‹œë„');
                
                // 2ìˆœìœ„: Brave API
                if (API_CONFIG.brave.enabled && API_CONFIG.brave.key) {
                    newsData = await fetchBraveNews();
                } else {
                    // 3ìˆœìœ„: ëŒ€ì²´ ë°ì´í„°
                    newsData = getFallbackNews();
                }
            }
            
            const newsList = document.getElementById('news-list');
            newsList.innerHTML = '';
            
            newsData.forEach((news, index) => {
                const newsItem = document.createElement('div');
                newsItem.className = 'news-item';
                
                const summary = summarizeNews(news.content, 70);
                
                // ë‰´ìŠ¤ ì†ŒìŠ¤ë³„ í‘œì‹œ êµ¬ë¶„
                let sourceIndicator;
                let borderColor;
                let backgroundGradient;
                
                switch (news.source) {
                    case 'ë§¤ì¼ê²½ì œ':
                        sourceIndicator = '<span style="color: var(--success-color); font-size: 0.7rem; font-weight: bold;">ğŸŸ¢ ë§¤ì¼ê²½ì œ</span>';
                        borderColor = 'var(--success-color)';
                        backgroundGradient = 'linear-gradient(90deg, rgba(16, 185, 129, 0.05) 0%, var(--background-color) 100%)';
                        break;
                    case 'íŒŒì´ë‚¸ì…œë‰´ìŠ¤':
                        sourceIndicator = '<span style="color: var(--warning-color); font-size: 0.7rem; font-weight: bold;">ğŸŸ¡ íŒŒì´ë‚¸ì…œë‰´ìŠ¤</span>';
                        borderColor = 'var(--warning-color)';
                        backgroundGradient = 'linear-gradient(90deg, rgba(245, 158, 11, 0.05) 0%, var(--background-color) 100%)';
                        break;
                    case 'Brave Search':
                        sourceIndicator = '<span style="color: var(--primary-color); font-size: 0.7rem; font-weight: bold;">ğŸ”´ Brave</span>';
                        borderColor = 'var(--danger-color)';
                        backgroundGradient = 'linear-gradient(90deg, rgba(239, 68, 68, 0.05) 0%, var(--background-color) 100%)';
                        break;
                    default:
                        sourceIndicator = '<span style="color: var(--neutral-color); font-size: 0.7rem;">ì‹œë®¬ë ˆì´ì…˜</span>';
                        borderColor = 'var(--primary-color)';
                        backgroundGradient = 'var(--background-color)';
                }
                
                newsItem.innerHTML = `
                    <div class="news-title">${news.title}</div>
                    <div class="news-summary">${summary}</div>
                    <div class="news-time">
                        ${formatTimeAgo(news.time)} | ${sourceIndicator}
                    </div>
                `;
                
                // ì†ŒìŠ¤ë³„ ìŠ¤íƒ€ì¼ ì ìš©
                newsItem.style.borderLeft = `3px solid ${borderColor}`;
                newsItem.style.background = backgroundGradient;
                
                // í´ë¦­ì‹œ ì›ë³¸ ë‰´ìŠ¤ë¡œ ì´ë™
                if (news.url && news.url !== '#') {
                    newsItem.style.cursor = 'pointer';
                    newsItem.addEventListener('click', () => {
                        window.open(news.url, '_blank');
                    });
                    newsItem.title = 'í´ë¦­í•˜ì—¬ ì›ë¬¸ ë³´ê¸°';
                }
                
                newsList.appendChild(newsItem);
            });
            
            console.log(`âœ… ë‰´ìŠ¤ ì—…ë°ì´íŠ¸ ì™„ë£Œ: ${newsData.length}ê°œ (ì†ŒìŠ¤: ${newsData[0]?.source || 'ì—†ìŒ'})`);
        }
        
        // KRX ì •ë³´ë°ì´í„°ì‹œìŠ¤í…œ ì „ì²´ì§€ìˆ˜ ë“±ë½ë¥  ë°ì´í„° ìŠ¤í¬ë˜í•‘
        async function fetchKRXIndicesData() {
            console.log('ğŸ›ï¸ KRX ì •ë³´ë°ì´í„°ì‹œìŠ¤í…œ ì „ì²´ì§€ìˆ˜ ë“±ë½ë¥  ìŠ¤í¬ë˜í•‘ ì‹œì‘...');
            
            try {
                // CORS í”„ë¡ì‹œë“¤ ì‹œë„
                const proxies = [
                    'https://api.allorigins.win/get?url=',
                    'https://cors-anywhere.herokuapp.com/',
                    'https://thingproxy.freeboard.io/fetch/'
                ];
                
                // KRX ì „ì²´ì§€ìˆ˜ ë“±ë½ë¥  í˜ì´ì§€
                const targetUrl = 'https://data.krx.co.kr/contents/MDC/MDI/mdiLoader/index.cmd?menuId=MDC0201010103';
                
                for (const proxy of proxies) {
                    try {
                        console.log(`ğŸ“¡ ${proxy}ë¡œ KRX ë°ì´í„° ì ‘ê·¼ ì‹œë„...`);
                        
                        const response = await fetch(proxy + encodeURIComponent(targetUrl));
                        let data;
                        
                        if (proxy.includes('allorigins')) {
                            const jsonData = await response.json();
                            data = jsonData.contents;
                        } else {
                            data = await response.text();
                        }
                        
                        if (data && data.length > 1000) {
                            const parser = new DOMParser();
                            const doc = parser.parseFromString(data, 'text/html');
                            
                            const indicesData = [];
                            
                            // KRX ì§€ìˆ˜ ë°ì´í„° ì¶”ì¶œ ì‹œë„ (ë‹¤ì–‘í•œ í…Œì´ë¸” êµ¬ì¡°)
                            const possibleSelectors = [
                                // KRX íŠ¹í™” ì…€ë ‰í„°
                                '.CI-GRID tbody tr',
                                '.data-list tbody tr', 
                                '.tbl-data tbody tr',
                                '.list tbody tr',
                                '.CI-GRID tr',
                                
                                // ì¼ë°˜ì ì¸ í…Œì´ë¸” ì…€ë ‰í„°
                                '.table tbody tr',
                                'table tbody tr',
                                '.data-table tr',
                                'table tr',
                                
                                // ì§€ìˆ˜ ê´€ë ¨ íŠ¹ìˆ˜ ì…€ë ‰í„°
                                '.index-table tr',
                                '.indices-list tr',
                                '.market-data tr',
                                '.sector-data tr'
                            ];
                            
                            for (const selector of possibleSelectors) {
                                const elements = doc.querySelectorAll(selector);
                                console.log(`ğŸ” ${selector}: ${elements.length}ê°œ ìš”ì†Œ ë°œê²¬`);
                                
                                elements.forEach((element, index) => {
                                    if (indicesData.length >= 10) return; // ìµœëŒ€ 10ê°œ
                                    
                                    // ì§€ìˆ˜ëª… ì¶”ì¶œ (KRX êµ¬ì¡°ì— ë§ê²Œ)
                                    const nameSelectors = [
                                        'td:first-child',
                                        'td:nth-child(1)',
                                        '.title',
                                        '.name',
                                        '.index-name',
                                        'a'
                                    ];
                                    
                                    let indexName = '';
                                    for (const nameSelector of nameSelectors) {
                                        const nameElement = element.querySelector(nameSelector);
                                        if (nameElement && nameElement.textContent.trim().length > 1) {
                                            indexName = nameElement.textContent.trim();
                                            break;
                                        }
                                    }
                                    
                                    // ë“±ë½ë¥  ì¶”ì¶œ (KRXëŠ” ë³´í†µ ë§ˆì§€ë§‰ ì—´ ë˜ëŠ” íŠ¹ì • ìœ„ì¹˜)
                                    const changeSelectors = [
                                        'td:last-child',
                                        'td:nth-last-child(1)',
                                        'td:nth-last-child(2)',
                                        'td:nth-child(4)',
                                        'td:nth-child(5)',
                                        'td:nth-child(6)',
                                        '.change',
                                        '.rate',
                                        '.percent'
                                    ];
                                    
                                    let changeText = '';
                                    for (const changeSelector of changeSelectors) {
                                        const changeElement = element.querySelector(changeSelector);
                                        if (changeElement) {
                                            const text = changeElement.textContent.trim();
                                            if (text.includes('%') || text.match(/^[+-]?\d+\.?\d*$/)) {
                                                changeText = text;
                                                break;
                                            }
                                        }
                                    }
                                    
                                    // í˜„ì¬ê°€ ì¶”ì¶œ
                                    const priceSelectors = [
                                        'td:nth-child(2)',
                                        'td:nth-child(3)',
                                        '.price',
                                        '.value'
                                    ];
                                    
                                    let priceText = '';
                                    for (const priceSelector of priceSelectors) {
                                        const priceElement = element.querySelector(priceSelector);
                                        if (priceElement && priceElement.textContent.match(/[\d,\.]+/)) {
                                            priceText = priceElement.textContent.trim();
                                            break;
                                        }
                                    }
                                    
                                    if (indexName && indexName.length > 2 && (changeText || priceText)) {
                                        // ë“±ë½ë¥  íŒŒì‹± (KRX í˜•ì‹: "2.34", "+2.34%", "-1.23%" ë“±)
                                        let changeValue = 0;
                                        const changeMatch = changeText.match(/([+-]?)(\d+\.?\d*)/);
                                        if (changeMatch) {
                                            changeValue = parseFloat(changeMatch[2]) * (changeMatch[1] === '-' ? -1 : 1);
                                        }
                                        
                                        // KRX ì„¹í„° ì§€ìˆ˜ ìš°ì„ ìˆœìœ„ ì„¤ì •
                                        const isSectorIndex = /ë°˜ë„ì²´|ë°”ì´ì˜¤|ê¸ˆìœµ|ì—ë„ˆì§€|ë¶€ë™ì‚°|IT|í†µì‹ |ì œì¡°ì—…|ì„œë¹„ìŠ¤ì—…|ê±´ì„¤ì—…|í™”í•™/.test(indexName);
                                        const isMainIndex = /KOSPI|KOSDAQ|KRX|ì½”ìŠ¤í”¼|ì½”ìŠ¤ë‹¥/.test(indexName);
                                        
                                        // ê´‘ê³ , ë§í¬, ë²„íŠ¼ ë“± ë¶ˆí•„ìš”í•œ ìš”ì†Œ í•„í„°ë§
                                        const isValidIndex = !indexName.match(/ì „ì²´ë³´ê¸°|ë”ë³´ê¸°|ë§í¬|ë²„íŠ¼|ë©”ë‰´|ë¡œê·¸ì¸|ê²€ìƒ‰|ê´‘ê³ /);
                                        
                                        if (isValidIndex) {
                                            indicesData.push({
                                                name: indexName.replace(/[^\wê°€-í£\s]/g, '').substring(0, 15).trim(),
                                                change: changeValue,
                                                price: priceText.replace(/[^\d,\.]/g, ''),
                                                source: 'KRX',
                                                isSector: isSectorIndex,
                                                isMain: isMainIndex,
                                                priority: isMainIndex ? 15 : 
                                                         isSectorIndex ? 12 : 5
                                            });
                                        }
                                    }
                                });
                                
                                if (indicesData.length > 0) {
                                    console.log(`âœ… ${selector}ì—ì„œ ${indicesData.length}ê°œ KRX ì§€ìˆ˜ ë°ì´í„° ì¶”ì¶œ`);
                                    break;
                                }
                            }
                            
                            if (indicesData.length > 0) {
                                // ìš°ì„ ìˆœìœ„ â†’ ë“±ë½ë¥  ìˆœìœ¼ë¡œ ì •ë ¬
                                indicesData.sort((a, b) => {
                                    if (a.priority !== b.priority) return b.priority - a.priority;
                                    return b.change - a.change;
                                });
                                
                                console.log(`âœ… KRXì—ì„œ ${indicesData.length}ê°œ ì§€ìˆ˜ ë°ì´í„° ìŠ¤í¬ë˜í•‘ ì„±ê³µ`);
                                console.log('ğŸ“ˆ ì¶”ì¶œëœ KRX ì§€ìˆ˜ë“¤:', indicesData.map(d => `${d.name}(${d.change}%)`));
                                
                                return indicesData.slice(0, 5); // Top 5
                            }
                        }
                        
                    } catch (proxyError) {
                        console.warn(`${proxy} ì‹¤íŒ¨:`, proxyError.message);
                        continue;
                    }
                }
                
                throw new Error('ëª¨ë“  í”„ë¡ì‹œ ì‹¤íŒ¨');
                
            } catch (error) {
                console.warn('âŒ KRX ë°ì´í„° ìŠ¤í¬ë˜í•‘ ì‹¤íŒ¨:', error.message);
                return null;
            }
        }
        
        // Investing.com ë‹¤ì¤‘ ì§€ìˆ˜ ì°¨íŠ¸ ë°ì´í„° ìŠ¤í¬ë˜í•‘ (2ìˆœìœ„ë¡œ ë³€ê²½)
        async function fetchInvestingIndicesData() {
            console.log('ğŸ“Š Investing.com ë‹¤ì¤‘ ì§€ìˆ˜ ë°ì´í„° ìŠ¤í¬ë˜í•‘ ì‹œì‘...');
            
            try {
                // CORS í”„ë¡ì‹œë“¤ ì‹œë„
                const proxies = [
                    'https://api.allorigins.win/get?url=',
                    'https://cors-anywhere.herokuapp.com/',
                    'https://thingproxy.freeboard.io/fetch/'
                ];
                
                const targetUrl = 'https://kr.investing.com/charts/multiple-indices-streaming-charts';
                
                for (const proxy of proxies) {
                    try {
                        console.log(`ğŸ“¡ ${proxy}ë¡œ Investing.com ì ‘ê·¼ ì‹œë„...`);
                        
                        const response = await fetch(proxy + encodeURIComponent(targetUrl));
                        let data;
                        
                        if (proxy.includes('allorigins')) {
                            const jsonData = await response.json();
                            data = jsonData.contents;
                        } else {
                            data = await response.text();
                        }
                        
                        if (data && data.length > 1000) {
                            const parser = new DOMParser();
                            const doc = parser.parseFromString(data, 'text/html');
                            
                            const indicesData = [];
                            
                            // Investing.com ë‹¤ì¤‘ ì§€ìˆ˜ ì°¨íŠ¸ ë°ì´í„° ì¶”ì¶œ ì‹œë„
                            const possibleSelectors = [
                                // ì¼ë°˜ì ì¸ ì§€ìˆ˜ í…Œì´ë¸”
                                '.indices-table tbody tr',
                                '.table-indices tr',
                                '.indices_table tr',
                                '.streaming-table tr',
                                
                                // ì„¹í„°ë³„ ì§€ìˆ˜
                                '.sector-indices tr',
                                '.sector_table tr',
                                '.sectors-list .sector-item',
                                
                                // êµ­ê°€ë³„ ì§€ìˆ˜
                                '.country-indices tr',
                                '.indices-by-country tr',
                                
                                // ë²”ìš© í…Œì´ë¸”
                                'table tbody tr',
                                '.data-table tr',
                                '.market-data tr'
                            ];
                            
                            for (const selector of possibleSelectors) {
                                const elements = doc.querySelectorAll(selector);
                                console.log(`ğŸ” ${selector}: ${elements.length}ê°œ ìš”ì†Œ ë°œê²¬`);
                                
                                elements.forEach((element, index) => {
                                    if (indicesData.length >= 10) return; // ìµœëŒ€ 10ê°œ
                                    
                                    // ì§€ìˆ˜ëª… ì¶”ì¶œ (ë‹¤ì–‘í•œ ìœ„ì¹˜ ì‹œë„)
                                    const nameSelectors = [
                                        '.symbol-name', '.instrument-name', '.index-name',
                                        'td:first-child', 'td:nth-child(1)',
                                        '.name', '.title', 'a'
                                    ];
                                    
                                    let indexName = '';
                                    for (const nameSelector of nameSelectors) {
                                        const nameElement = element.querySelector(nameSelector);
                                        if (nameElement && nameElement.textContent.trim().length > 1) {
                                            indexName = nameElement.textContent.trim();
                                            break;
                                        }
                                    }
                                    
                                    // ë“±ë½ë¥  ì¶”ì¶œ (ë‹¤ì–‘í•œ ìœ„ì¹˜ ì‹œë„)
                                    const changeSelectors = [
                                        '.change-percent', '.percent-change', '.change-pct',
                                        '.change', '.rate', '.percent',
                                        'td:last-child', 'td:nth-last-child(1)', 'td:nth-last-child(2)'
                                    ];
                                    
                                    let changeText = '';
                                    for (const changeSelector of changeSelectors) {
                                        const changeElement = element.querySelector(changeSelector);
                                        if (changeElement && changeElement.textContent.includes('%')) {
                                            changeText = changeElement.textContent.trim();
                                            break;
                                        }
                                    }
                                    
                                    // í˜„ì¬ê°€ ì¶”ì¶œ
                                    const priceSelectors = [
                                        '.price', '.last-price', '.current-price',
                                        'td:nth-child(2)', 'td:nth-child(3)'
                                    ];
                                    
                                    let priceText = '';
                                    for (const priceSelector of priceSelectors) {
                                        const priceElement = element.querySelector(priceSelector);
                                        if (priceElement && priceElement.textContent.match(/[\d,\.]+/)) {
                                            priceText = priceElement.textContent.trim();
                                            break;
                                        }
                                    }
                                    
                                    if (indexName && (changeText || priceText)) {
                                        // ë“±ë½ë¥  íŒŒì‹± (ì˜ˆ: "+2.34%", "-1.23%" -> 2.34, -1.23)
                                        let changeValue = 0;
                                        const changeMatch = changeText.match(/([+-]?)(\d+\.?\d*)/);
                                        if (changeMatch) {
                                            changeValue = parseFloat(changeMatch[2]) * (changeMatch[1] === '-' ? -1 : 1);
                                        }
                                        
                                        // í•œêµ­ ì„¹í„°/ì§€ìˆ˜ ìš°ì„  (KOSPI, KOSDAQ, KRX ë“±)
                                        const isKoreanIndex = /KOSPI|KOSDAQ|KRX|í•œêµ­|Korea|KS11|KQ11/.test(indexName);
                                        
                                        indicesData.push({
                                            name: indexName.replace(/[^\wê°€-í£\s]/g, '').substring(0, 15).trim(),
                                            change: changeValue,
                                            price: priceText.replace(/[^\d,\.]/g, ''),
                                            source: 'Investing.com',
                                            isKorean: isKoreanIndex,
                                            priority: isKoreanIndex ? 10 : 
                                                     /ë°˜ë„ì²´|ë°”ì´ì˜¤|ê¸ˆìœµ|ì—ë„ˆì§€|ë¶€ë™ì‚°|IT|í†µì‹ /.test(indexName) ? 8 :
                                                     /NASDAQ|S&P|DOW|FTSE|DAX|Nikkei/.test(indexName) ? 6 : 1
                                        });
                                    }
                                });
                                
                                if (indicesData.length > 0) {
                                    console.log(`âœ… ${selector}ì—ì„œ ${indicesData.length}ê°œ ì§€ìˆ˜ ë°ì´í„° ì¶”ì¶œ`);
                                    break;
                                }
                            }
                            
                            if (indicesData.length > 0) {
                                // ìš°ì„ ìˆœìœ„ â†’ ë“±ë½ë¥  ìˆœìœ¼ë¡œ ì •ë ¬
                                indicesData.sort((a, b) => {
                                    if (a.priority !== b.priority) return b.priority - a.priority;
                                    return b.change - a.change;
                                });
                                
                                console.log(`âœ… Investing.comì—ì„œ ${indicesData.length}ê°œ ì§€ìˆ˜ ë°ì´í„° ìŠ¤í¬ë˜í•‘ ì„±ê³µ`);
                                console.log('ğŸ“ˆ ì¶”ì¶œëœ ì§€ìˆ˜ë“¤:', indicesData.map(d => `${d.name}(${d.change}%)`));
                                
                                return indicesData.slice(0, 5); // Top 5
                            }
                        }
                        
                    } catch (proxyError) {
                        console.warn(`${proxy} ì‹¤íŒ¨:`, proxyError.message);
                        continue;
                    }
                }
                
                throw new Error('ëª¨ë“  í”„ë¡ì‹œ ì‹¤íŒ¨');
                
            } catch (error) {
                console.warn('âŒ Investing.com ìŠ¤í¬ë˜í•‘ ì‹¤íŒ¨:', error.message);
                return null;
            }
        }
        
        // Daum ê¸ˆìœµ WICS ì„¹í„° ë°ì´í„° ìŠ¤í¬ë˜í•‘ (ê¸°ì¡´ ìœ ì§€)
        async function fetchDaumSectorData() {
            console.log('ğŸ­ Daum ê¸ˆìœµ WICS ì„¹í„° ë°ì´í„° ìŠ¤í¬ë˜í•‘ ì‹œì‘...');
            
            try {
                // CORS í”„ë¡ì‹œë“¤ ì‹œë„
                const proxies = [
                    'https://api.allorigins.win/get?url=',
                    'https://cors-anywhere.herokuapp.com/',
                    'https://thingproxy.freeboard.io/fetch/'
                ];
                
                const targetUrl = 'https://finance.daum.net/domestic/wics';
                
                for (const proxy of proxies) {
                    try {
                        console.log(`ğŸ“¡ ${proxy}ë¡œ Daum ê¸ˆìœµ ì ‘ê·¼ ì‹œë„...`);
                        
                        const response = await fetch(proxy + encodeURIComponent(targetUrl));
                        let data;
                        
                        if (proxy.includes('allorigins')) {
                            const jsonData = await response.json();
                            data = jsonData.contents;
                        } else {
                            data = await response.text();
                        }
                        
                        if (data && data.length > 1000) {
                            const parser = new DOMParser();
                            const doc = parser.parseFromString(data, 'text/html');
                            
                            // WICS ì„¹í„° ë°ì´í„° ì¶”ì¶œ ì‹œë„
                            const sectorData = [];
                            
                            // ë‹¤ì–‘í•œ ì…€ë ‰í„°ë¡œ ì„¹í„° ë°ì´í„° ì¶”ì¶œ ì‹œë„
                            const possibleSelectors = [
                                '.sector_list .sector_item',
                                '.wics_list .wics_item', 
                                '.list_wics li',
                                '.table_wics tbody tr',
                                'table tr',
                                '.sector_table tr'
                            ];
                            
                            for (const selector of possibleSelectors) {
                                const elements = doc.querySelectorAll(selector);
                                
                                elements.forEach((element, index) => {
                                    if (sectorData.length >= 5) return; // Top 5ë§Œ
                                    
                                    // ì„¹í„°ëª… ì¶”ì¶œ
                                    const nameElement = element.querySelector('.name, .sector_name, td:first-child, .title') || element;
                                    const sectorName = nameElement?.textContent?.trim();
                                    
                                    // ë“±ë½ë¥  ì¶”ì¶œ  
                                    const changeElement = element.querySelector('.change, .rate, .percent, td:last-child') || 
                                                        element.querySelector('[class*="change"]') ||
                                                        element.querySelector('[class*="rate"]');
                                    const changeText = changeElement?.textContent?.trim();
                                    
                                    if (sectorName && changeText && sectorName.length > 1) {
                                        // ë“±ë½ë¥  íŒŒì‹± (ì˜ˆ: "+2.34%" -> 2.34)
                                        const changeMatch = changeText.match(/([+-]?)(\d+\.?\d*)/);
                                        const changeValue = changeMatch ? 
                                            parseFloat(changeMatch[2]) * (changeMatch[1] === '-' ? -1 : 1) : 0;
                                        
                                        sectorData.push({
                                            name: sectorName.replace(/[^\wê°€-í£]/g, '').substring(0, 10), // ì •ë¦¬
                                            change: changeValue,
                                            source: 'Daum WICS'
                                        });
                                    }
                                });
                                
                                if (sectorData.length > 0) break; // ë°ì´í„°ë¥¼ ì°¾ìœ¼ë©´ ì¤‘ë‹¨
                            }
                            
                            if (sectorData.length > 0) {
                                // ë“±ë½ë¥ ë¡œ ì •ë ¬ (ìƒìŠ¹ë¥  ë†’ì€ ìˆœ)
                                sectorData.sort((a, b) => b.change - a.change);
                                
                                console.log(`âœ… Daumì—ì„œ ${sectorData.length}ê°œ ì„¹í„° ë°ì´í„° ìŠ¤í¬ë˜í•‘ ì„±ê³µ`);
                                return sectorData.slice(0, 5); // Top 5
                            }
                        }
                        
                    } catch (proxyError) {
                        console.warn(`${proxy} ì‹¤íŒ¨:`, proxyError.message);
                        continue;
                    }
                }
                
                throw new Error('ëª¨ë“  í”„ë¡ì‹œ ì‹¤íŒ¨');
                
            } catch (error) {
                console.warn('âŒ Daum ê¸ˆìœµ ìŠ¤í¬ë˜í•‘ ì‹¤íŒ¨:', error.message);
                return null;
            }
        }
        
        // ì‹¤ì‹œê°„ ì„¹í„° ë¶„ì„ (ê³µê³µë°ì´í„°í¬í„¸ API â†’ KRX â†’ Investing.com â†’ Daum WICS â†’ ê¸€ë¡œë²Œ ë°ì´í„° â†’ ë‰´ìŠ¤ í‚¤ì›Œë“œ ìˆœ)
        async function updateSectorAnalysis() {
            console.log('ğŸ­ ì„¹í„° ë™í–¥ ì—…ë°ì´íŠ¸ ì‹œì‘...');
            
            let sectors = [];
            let dataSource = '';
            
            // 1ìˆœìœ„: ê³µê³µë°ì´í„°í¬í„¸ ì§€ìˆ˜ì‹œì„¸ì •ë³´ API (ì„¹í„° ë™í–¥ìš©)
            try {
                const koreaIndexData = await fetchKoreaIndexAPI();
                if (koreaIndexData && koreaIndexData.length > 0) {
                    sectors = koreaIndexData;
                    dataSource = 'ê³µê³µë°ì´í„°í¬í„¸';
                    console.log('âœ… ê³µê³µë°ì´í„°í¬í„¸ ì§€ìˆ˜ì‹œì„¸ì •ë³´ API ë°ì´í„° ì‚¬ìš©');
                } else {
                    throw new Error('ê³µê³µë°ì´í„°í¬í„¸ API ì‹¤íŒ¨');
                }
            } catch (error) {
                console.warn('ê³µê³µë°ì´í„°í¬í„¸ API ì‹¤íŒ¨, ê¸°ì¡´ ë¡œì§ ì‚¬ìš©...');
                
                // 2ìˆœìœ„ ì´í›„: ê¸°ì¡´ ì‹œìŠ¤í…œ ê·¸ëŒ€ë¡œ ìœ ì§€
                try {
                    const globalStockData = await fetchGlobalStockData();
                    const cryptoData = await fetchCryptoData();
                    const recentNews = await fetchKoreanNews();
                    const sectorMentions = analyzeSectorMentions(recentNews);
                    
                    // ê¸°ë³¸ ì„¹í„° ë°ì´í„°
                    sectors = [
                        { name: 'ë°˜ë„ì²´', baseChange: 2.8, newsBoost: 0, realData: null },
                        { name: 'ë°”ì´ì˜¤', baseChange: 1.5, newsBoost: 0, realData: null },
                        { name: 'ê¸ˆìœµ', baseChange: -0.5, newsBoost: 0, realData: null },
                        { name: 'ì—ë„ˆì§€', baseChange: -2.0, newsBoost: 0, realData: null },
                        { name: 'ë¶€ë™ì‚°', baseChange: -2.5, newsBoost: 0, realData: null }
                    ];
                    
                    // ê¸€ë¡œë²Œ ë°ì´í„°ë¡œ ì„¹í„° ì¶”ì •
                    if (globalStockData) {
                        if (globalStockData.QQQ) {
                            sectors[0].realData = globalStockData.QQQ.change * 0.9; // ë°˜ë„ì²´
                            sectors[1].realData = globalStockData.QQQ.change * 0.6; // ë°”ì´ì˜¤
                        }
                        if (globalStockData.SPY) {
                            sectors[2].realData = globalStockData.SPY.change * 1.1; // ê¸ˆìœµ
                        }
                    }
                    
                    // ë‰´ìŠ¤ í‚¤ì›Œë“œë¡œ ë¶€ìŠ¤íŠ¸ ì ìš©
                    sectors.forEach(sector => {
                        const mentions = sectorMentions[sector.name] || 0;
                        sector.newsBoost = mentions * 0.3;
                    });
                    
                    // ìµœì¢… ë³€í™”ìœ¨ ê³„ì‚°
                    sectors.forEach(sector => {
                        sector.change = sector.realData !== null ? 
                            sector.realData + sector.newsBoost :
                            sector.baseChange + sector.newsBoost + (Math.random() - 0.5) * 0.5;
                        sector.source = 'ê¸€ë¡œë²Œ+ë‰´ìŠ¤';
                    });
                    
                    dataSource = 'ê¸€ë¡œë²Œ+ë‰´ìŠ¤';
                    console.log('âœ… ê¸€ë¡œë²Œ ë°ì´í„° + ë‰´ìŠ¤ í‚¤ì›Œë“œ ì‚¬ìš©');
                    
                } catch (fallbackError) {
                    console.error('âŒ ëª¨ë“  ë°ì´í„° ì†ŒìŠ¤ ì‹¤íŒ¨, ê¸°ë³¸ê°’ ì‚¬ìš©:', fallbackError);
                    
                    // ìµœì¢…: ê¸°ë³¸ ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„°
                    sectors = [
                        { name: 'ë°˜ë„ì²´', change: 2.8 + Math.random() * 1.0, source: 'ì‹œë®¬ë ˆì´ì…˜' },
                        { name: 'ë°”ì´ì˜¤', change: 1.5 + Math.random() * 0.8, source: 'ì‹œë®¬ë ˆì´ì…˜' },
                        { name: 'ê¸ˆìœµ', change: -0.5 + Math.random() * 1.0, source: 'ì‹œë®¬ë ˆì´ì…˜' },
                        { name: 'ì—ë„ˆì§€', change: -2.0 + Math.random() * 1.0, source: 'ì‹œë®¬ë ˆì´ì…˜' },
                        { name: 'ë¶€ë™ì‚°', change: -2.5 + Math.random() * 0.8, source: 'ì‹œë®¬ë ˆì´ì…˜' }
                    ];
                    dataSource = 'ì‹œë®¬ë ˆì´ì…˜';
                }
            }
            
            // UI ì—…ë°ì´íŠ¸
            const sectorList = document.getElementById('sector-list');
            sectorList.innerHTML = '';
            
            // ìƒìœ„ 5ê°œë§Œ í‘œì‹œ
            sectors.slice(0, 5).forEach((sector, index) => {
                const sectorItem = document.createElement('div');
                sectorItem.className = 'sector-item';
                
                const changeClass = sector.change > 0.5 ? 'positive' : 
                                  sector.change < -0.5 ? 'negative' : 'neutral';
                
                // ë°ì´í„° ì†ŒìŠ¤ë³„ ì•„ì´ì½˜
                let sourceIcon = '';
                switch (dataSource) {
                    case 'ê³µê³µë°ì´í„°í¬í„¸':
                        sourceIcon = 'ğŸ‡°ğŸ‡·';
                        break;
                    case 'KRX':
                        sourceIcon = 'ğŸ›ï¸';
                        break;
                    case 'Investing.com':
                        sourceIcon = 'ğŸ”µ';
                        break;
                    case 'Daum WICS':
                        sourceIcon = 'ğŸŸ¢';
                        break;
                    case 'Yahoo Finance':
                        sourceIcon = 'ğŸŸ£';
                        break;
                    case 'FMP API':
                        sourceIcon = 'ğŸ’¼';
                        break;
                    case 'íŠ¸ë Œë“œ ë¶„ì„':
                        sourceIcon = 'ğŸ­';
                        break;
                    case 'ê¸€ë¡œë²Œ+ë‰´ìŠ¤':
                        sourceIcon = 'ğŸŸ¡';
                        break;
                    default:
                        sourceIcon = 'âšª';
                }
                
                // ìˆœìœ„ í‘œì‹œ (1-5ìœ„)
                const rankIcon = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰', '4ï¸âƒ£', '5ï¸âƒ£'][index] || 'ğŸ“ˆ';
                
                // ì§€ìˆ˜ ì¢…ë¥˜ë³„ ì¶”ê°€ ì •ë³´
                let additionalInfo = '';
                if (dataSource === 'KRX') {
                    if (sector.isMain) {
                        additionalInfo = ' ğŸ“Š'; // ì£¼ìš” ì§€ìˆ˜
                    } else if (sector.isSector) {
                        additionalInfo = ' ğŸ¢'; // ì„¹í„° ì§€ìˆ˜
                    }
                    if (sector.price) {
                        additionalInfo += ` (${sector.price})`;
                    }
                } else if (dataSource === 'Investing.com' && sector.isKorean) {
                    additionalInfo = ' ğŸ‡°ğŸ‡·';
                } else if (dataSource === 'Investing.com' && sector.price) {
                    additionalInfo = ` (${sector.price})`;
                }
                
                sectorItem.innerHTML = `
                    <span class="sector-name">${rankIcon} ${sector.name}${additionalInfo} ${sourceIcon}</span>
                    <span class="sector-change ${changeClass}">${formatChange(sector.change)}</span>
                `;
                
                // ë°ì´í„° ì†ŒìŠ¤ë³„ íŠ¹ë³„ í‘œì‹œ
                if (dataSource === 'ê³µê³µë°ì´í„°í¬í„¸') {
                    sectorItem.style.background = 'linear-gradient(90deg, rgba(0, 123, 255, 0.2) 0%, var(--background-color) 100%)';
                    sectorItem.style.borderLeft = '4px solid #007BFF';
                    sectorItem.style.fontWeight = '700'; // ê³µê³µë°ì´í„°í¬í„¸ì€ ê°€ì¥ êµµê²Œ
                    sectorItem.style.boxShadow = '0 2px 8px rgba(0, 123, 255, 0.1)';
                } else if (dataSource === 'KRX') {
                    sectorItem.style.background = 'linear-gradient(90deg, rgba(255, 215, 0, 0.15) 0%, var(--background-color) 100%)';
                    sectorItem.style.borderLeft = '3px solid #FFD700';
                    sectorItem.style.fontWeight = '600'; // KRX ê³µì‹ ë°ì´í„°ëŠ” êµµê²Œ
                } else if (dataSource === 'Investing.com') {
                    sectorItem.style.background = 'linear-gradient(90deg, rgba(59, 130, 246, 0.1) 0%, var(--background-color) 100%)';
                    sectorItem.style.borderLeft = '3px solid var(--primary-color)';
                } else if (dataSource === 'Daum WICS') {
                    sectorItem.style.background = 'linear-gradient(90deg, rgba(16, 185, 129, 0.1) 0%, var(--background-color) 100%)';
                    sectorItem.style.borderLeft = '3px solid var(--success-color)';
                } else if (dataSource === 'Yahoo Finance') {
                    sectorItem.style.background = 'linear-gradient(90deg, rgba(138, 43, 226, 0.1) 0%, var(--background-color) 100%)';
                    sectorItem.style.borderLeft = '3px solid #8A2BE2';
                } else if (dataSource === 'FMP API') {
                    sectorItem.style.background = 'linear-gradient(90deg, rgba(255, 140, 0, 0.1) 0%, var(--background-color) 100%)';
                    sectorItem.style.borderLeft = '3px solid #FF8C00';
                } else if (dataSource === 'íŠ¸ë Œë“œ ë¶„ì„') {
                    sectorItem.style.background = 'linear-gradient(90deg, rgba(255, 20, 147, 0.1) 0%, var(--background-color) 100%)';
                    sectorItem.style.borderLeft = '3px solid #FF1493';
                }
                
                sectorList.appendChild(sectorItem);
            });
            
            console.log(`âœ… ì„¹í„° ë™í–¥ ì—…ë°ì´íŠ¸ ì™„ë£Œ (${dataSource}, ${sectors.length}ê°œ ì„¹í„°)`);
        }
        
        // ë‰´ìŠ¤ì—ì„œ ì„¹í„° ê´€ë ¨ í‚¤ì›Œë“œ ë¶„ì„
        function analyzeSectorMentions(newsData) {
            const sectorKeywords = {
                'ë°˜ë„ì²´': ['ë°˜ë„ì²´', 'ì‚¼ì„±ì „ì', 'ë©”ëª¨ë¦¬', 'SKí•˜ì´ë‹‰ìŠ¤', 'íŒŒìš´ë“œë¦¬', 'ì¹©', 'ì›¨ì´í¼'],
                'ë°”ì´ì˜¤': ['ë°”ì´ì˜¤', 'ì œì•½', 'ì˜ë£Œ', 'ë°±ì‹ ', 'ì‹ ì•½', 'í—¬ìŠ¤ì¼€ì–´', 'ë³‘ì›'],
                'ê¸ˆìœµ': ['ì€í–‰', 'ê¸ˆìœµ', 'ë³´í—˜', 'ì¦ê¶Œ', 'ì¹´ë“œ', 'í•€í…Œí¬', 'ëŒ€ì¶œ'],
                'ì—ë„ˆì§€': ['ì—ë„ˆì§€', 'ì„ìœ ', 'ì „ë ¥', 'ê°€ìŠ¤', 'ì‹ ì¬ìƒ', 'ì›ì „', 'íƒœì–‘ê´‘'],
                'ë¶€ë™ì‚°': ['ë¶€ë™ì‚°', 'ê±´ì„¤', 'ì•„íŒŒíŠ¸', 'ì£¼íƒ', 'í† ì§€', 'ì¬ê°œë°œ']
            };
            
            const mentions = {};
            
            Object.keys(sectorKeywords).forEach(sector => {
                mentions[sector] = 0;
                
                newsData.forEach(news => {
                    const text = (news.title + ' ' + news.content).toLowerCase();
                    
                    sectorKeywords[sector].forEach(keyword => {
                        if (text.includes(keyword)) {
                            mentions[sector]++;
                        }
                    });
                });
            });
            
            return mentions;
        }
        
        // === ì°¨íŠ¸ ê´€ë¦¬ ===
        
        function initMainChart() {
            const ctx = document.getElementById('mainChart').getContext('2d');
            
            const timeLabels = Array.from({length: 7}, (_, i) => {
                const time = new Date();
                time.setHours(time.getHours() - (6-i));
                return time.getHours() + ':00';
            });
            
            const kospiData = Array.from({length: 7}, () => 2600 + Math.random() * 100);
            const volumeData = Array.from({length: 7}, () => Math.random() * 100);
            
            mainChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: timeLabels,
                    datasets: [
                        {
                            label: 'KOSPI',
                            data: kospiData,
                            borderColor: 'var(--primary-color)',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            tension: 0.4,
                            fill: true,
                            borderWidth: 3,
                            pointBackgroundColor: 'var(--primary-color)',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 5
                        },
                        {
                            label: 'ê±°ë˜ëŸ‰',
                            data: volumeData,
                            type: 'bar',
                            backgroundColor: 'rgba(245, 158, 11, 0.6)',
                            borderColor: 'var(--warning-color)',
                            borderWidth: 1,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: 'var(--text-primary)',
                                font: { weight: 600 }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            borderColor: 'var(--primary-color)',
                            borderWidth: 1
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: 'var(--border-color)' },
                            ticks: { color: 'var(--text-secondary)' }
                        },
                        y: {
                            beginAtZero: false,
                            grid: { color: 'var(--border-color)' },
                            ticks: { color: 'var(--text-secondary)' }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            grid: { drawOnChartArea: false },
                            ticks: { color: 'var(--text-secondary)' }
                        }
                    }
                }
            });
        }
        
        // ì‹¤ì‹œê°„ ì‹œì¥ ë™í–¥ ì°¨íŠ¸ ì—…ë°ì´íŠ¸ (ì‹¤ì œ ë°ì´í„° ê¸°ë°˜)
        async function updateMainChart() {
            if (!mainChart) return;
            
            console.log('ğŸ“ˆ ì‹¤ì‹œê°„ ì‹œì¥ ë™í–¥ ì°¨íŠ¸ ì—…ë°ì´íŠ¸ ì‹œì‘...');
            
            try {
                // ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì§‘
                const exchangeRates = await fetchExchangeRate();
                const globalStockData = await fetchGlobalStockData();
                const cryptoData = await fetchCryptoData();
                const koreanStockData = await fetchKoreanStockData();
                
                // ì‹œê°„ ë ˆì´ë¸” ìƒì„± (ìµœê·¼ 7ì‹œê°„)
                const timeLabels = Array.from({length: 7}, (_, i) => {
                    const time = new Date();
                    time.setHours(time.getHours() - (6-i));
                    return time.getHours() + ':00';
                });
                
                // KOSPI ë°ì´í„° ìƒì„± (ì‹¤ì œ ë°ì´í„° ê¸°ë°˜)
                let baseKospi = 2650;
                let kospiTrend = 0;
                
                // í•œêµ­ ì£¼ì‹ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì‚¬ìš©
                if (koreanStockData && koreanStockData.kospi) {
                    baseKospi = koreanStockData.kospi.current;
                    kospiTrend = koreanStockData.kospi.change / 100;
                } else if (globalStockData && globalStockData.SPY) {
                    // ê¸€ë¡œë²Œ ë°ì´í„°ë¡œ ì¶”ì •
                    kospiTrend = globalStockData.SPY.change / 100 * 0.8; // ë¯¸êµ­ ì‹œì¥ì˜ 80% ì—°ë™
                } else {
                    // í™˜ìœ¨ê³¼ ì•”í˜¸í™”íë¡œ ì¶”ì •
                    kospiTrend = (1324 - exchangeRates.usdKrw) / 1324 * 0.02; // í™˜ìœ¨ ì˜í–¥
                    if (cryptoData && cryptoData.bitcoin) {
                        kospiTrend += (cryptoData.bitcoin.usd_24h_change || 0) / 100 * 0.1; // ë¹„íŠ¸ì½”ì¸ ì˜í–¥
                    }
                }
                
                // 7ì‹œê°„ ë™ì•ˆì˜ KOSPI ì¶”ì´ ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì œ íŠ¸ë Œë“œ ë°˜ì˜)
                const kospiData = [];
                for (let i = 0; i < 7; i++) {
                    const progress = i / 6; // 0 to 1
                    const trendInfluence = kospiTrend * progress * 100; // ì ì§„ì  ë°˜ì˜
                    const noise = (Math.random() - 0.5) * 20; // ì‘ì€ ëœë¤ ë³€ë™
                    kospiData.push(baseKospi + trendInfluence + noise);
                }
                
                // ê±°ë˜ëŸ‰ ë°ì´í„° (ì‹¤ì œ ë™í–¥ ë°˜ì˜)
                const volumeData = [];
                const baseVolume = 50;
                for (let i = 0; i < 7; i++) {
                    // ë³€í™”ìœ¨ì´ í´ìˆ˜ë¡ ê±°ë˜ëŸ‰ ì¦ê°€
                    const volatilityBoost = Math.abs(kospiTrend) * 200;
                    const noise = Math.random() * 30;
                    volumeData.push(baseVolume + volatilityBoost + noise);
                }
                
                // í™˜ìœ¨ ë°ì´í„° ì¶”ê°€ (ì‹¤ì‹œê°„)
                const usdKrwData = [];
                const baseRate = exchangeRates.usdKrw;
                for (let i = 0; i < 7; i++) {
                    const variation = (Math.random() - 0.5) * 10; // Â±5ì› ë³€ë™
                    usdKrwData.push(baseRate + variation);
                }
                
                // ì°¨íŠ¸ ë°ì´í„° ì—…ë°ì´íŠ¸
                mainChart.data.labels = timeLabels;
                mainChart.data.datasets[0].data = kospiData;
                mainChart.data.datasets[1].data = volumeData;
                
                // í™˜ìœ¨ ë°ì´í„°ì…‹ì´ ì—†ìœ¼ë©´ ì¶”ê°€
                if (mainChart.data.datasets.length < 3) {
                    mainChart.data.datasets.push({
                        label: 'USD/KRW',
                        data: usdKrwData,
                        type: 'line',
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y2',
                        borderWidth: 2
                    });
                    
                    // Yì¶• ì¶”ê°€
                    mainChart.options.scales.y2 = {
                        type: 'linear',
                        display: true,
                        position: 'right',
                        title: { display: true, text: 'í™˜ìœ¨' },
                        grid: { drawOnChartArea: false },
                        ticks: { color: 'var(--text-secondary)' }
                    };
                } else {
                    mainChart.data.datasets[2].data = usdKrwData;
                }
                
                mainChart.update('none');
                
                // ë°ì´í„° ì†ŒìŠ¤ ë¡œê¹…
                let dataSource = 'ğŸ“Š ì°¨íŠ¸ ë°ì´í„° ì†ŒìŠ¤: ';
                if (koreanStockData) dataSource += 'í•œêµ­ì£¼ì‹ ';
                if (globalStockData) dataSource += 'ê¸€ë¡œë²Œì£¼ì‹ ';
                dataSource += 'í™˜ìœ¨ ';
                if (cryptoData) dataSource += 'ì•”í˜¸í™”í';
                
                console.log(`âœ… ${dataSource}`);
                console.log(`ğŸ“ˆ KOSPI íŠ¸ë Œë“œ: ${(kospiTrend * 100).toFixed(2)}%`);
                
            } catch (error) {
                console.error('âŒ ì°¨íŠ¸ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨, ê¸°ë³¸ ë°ì´í„° ì‚¬ìš©:', error);
                
                // ì‹¤íŒ¨ì‹œ ê¸°ë³¸ ëœë¤ ë°ì´í„°
                const newKospiData = Array.from({length: 7}, () => 2600 + Math.random() * 100);
                const newVolumeData = Array.from({length: 7}, () => Math.random() * 100);
                
                mainChart.data.datasets[0].data = newKospiData;
                mainChart.data.datasets[1].data = newVolumeData;
                mainChart.update('none');
            }
        }
        
        // === ìŠ¬ë¼ì´ë“œ ë¹„ìœ¨ ê´€ë¦¬ ===
        
        function setSlideRatio(ratio) {
            const body = document.body;
            const buttons = document.querySelectorAll('.ratio-btn');
            
            body.classList.remove('slide-ratio-4-3');
            
            if (ratio === '4:3') {
                body.classList.add('slide-ratio-4-3');
            }
            
            buttons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent === ratio) {
                    btn.classList.add('active');
                }
            });
            
            currentSlideRatio = ratio;
            
            setTimeout(() => {
                if (mainChart) {
                    mainChart.resize();
                }
            }, 300);
            
            console.log(`ìŠ¬ë¼ì´ë“œ ë¹„ìœ¨ ë³€ê²½: ${ratio}`);
        }
        
        // === ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ===
        
        function updateCurrentTime() {
            const timeElement = document.getElementById('current-time');
            timeElement.textContent = formatTime(new Date());
        }
        
        async function updateAllData() {
            console.log('ğŸ”„ ì „ì²´ ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹œì‘...');
            
            try {
                await Promise.all([
                    updateMarketIndicators(),
                    updateNews(),
                    updateSectorAnalysis()
                ]);
                
                updateMainChart();
                updateCurrentTime();
                
                console.log('âœ… ë°ì´í„° ì—…ë°ì´íŠ¸ ì™„ë£Œ:', new Date().toLocaleTimeString());
            } catch (error) {
                console.error('âŒ ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
            }
        }
        
        // === API ìƒíƒœ ê´€ë¦¬ ===
        
        // API ì—°ê²° í…ŒìŠ¤íŠ¸
        async function testAPIConnections() {
            console.log('ğŸ§ª API ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹œì‘...');
            
            const results = {
                brave: false,
                exchangeRate: false,
                coinGecko: false,
                alphaVantage: false,
                finnhub: false
            };
            
            // Brave API í…ŒìŠ¤íŠ¸
            if (API_CONFIG.brave.enabled && API_CONFIG.brave.key) {
                try {
                    const testUrl = `${API_CONFIG.brave.baseUrl}?q=test&count=1`;
                    const response = await fetch(testUrl, {
                        headers: {
                            'Accept': 'application/json',
                            'X-Subscription-Token': API_CONFIG.brave.key
                        }
                    });
                    results.brave = response.ok;
                } catch (error) {
                    console.warn('Brave API í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error.message);
                }
            }
            
            // í™˜ìœ¨ API í…ŒìŠ¤íŠ¸
            try {
                const response = await fetch(API_CONFIG.exchangeRate.url);
                results.exchangeRate = response.ok;
            } catch (error) {
                console.warn('í™˜ìœ¨ API í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error.message);
            }
            
            // CoinGecko API í…ŒìŠ¤íŠ¸
            try {
                const response = await fetch(`${API_CONFIG.coinGecko.baseUrl}/ping`);
                results.coinGecko = response.ok;
            } catch (error) {
                console.warn('CoinGecko API í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error.message);
            }
            
            console.log('ğŸ” API ì—°ê²° ìƒíƒœ:', results);
            return results;
        }
        
        // API ìƒíƒœ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateAPIStatus(apiResults) {
            const liveIndicator = document.querySelector('.live-indicator');
            const connectedAPIs = Object.values(apiResults).filter(Boolean).length;
            const totalAPIs = Object.keys(apiResults).length;
            
            if (connectedAPIs > 0) {
                liveIndicator.textContent = `LIVE (${connectedAPIs}/${totalAPIs})`;
                liveIndicator.style.background = connectedAPIs === totalAPIs ? 'var(--success-color)' : 'var(--warning-color)';
            } else {
                liveIndicator.textContent = 'DEMO';
                liveIndicator.style.background = 'var(--neutral-color)';
            }
        }
        
        // === ì´ˆê¸°í™” ===
        
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('ğŸš€ Daily Economy Dashboard ì´ˆê¸°í™” ì‹œì‘...');
            console.log('ğŸ”‘ ì‚¬ìš© ì¤‘ì¸ API í‚¤ë“¤:');
            console.log('- Brave API:', API_CONFIG.brave.key ? 'âœ… ì„¤ì •ë¨' : 'âŒ ì—†ìŒ');
            console.log('- Alpha Vantage:', API_CONFIG.alphaVantage.key ? 'âœ… ì„¤ì •ë¨' : 'âŒ ì—†ìŒ');
            console.log('- Finnhub:', API_CONFIG.finnhub.key ? 'âœ… ì„¤ì •ë¨' : 'âŒ ì—†ìŒ');
            
            // API ì—°ê²° í…ŒìŠ¤íŠ¸
            const apiStatus = await testAPIConnections();
            updateAPIStatus(apiStatus);
            
            // ì°¨íŠ¸ ì´ˆê¸°í™”
            initMainChart();
            
            // ì´ˆê¸° ë°ì´í„° ë¡œë”©
            await updateAllData();
            
            // ì •ê¸° ì—…ë°ì´íŠ¸ ì„¤ì •
            const updateInterval = API_CONFIG.brave.enabled ? 30000 : 60000; // Brave API ì‚¬ìš©ì‹œ 30ì´ˆ, ì•„ë‹ˆë©´ 60ì´ˆ
            setInterval(updateAllData, updateInterval);
            
            // 1ë¶„ë§ˆë‹¤ ì‹œê°„ ì—…ë°ì´íŠ¸
            setInterval(updateCurrentTime, 60000);
            
            // 5ë¶„ë§ˆë‹¤ API ìƒíƒœ ì¬í™•ì¸
            setInterval(async () => {
                const newApiStatus = await testAPIConnections();
                updateAPIStatus(newApiStatus);
            }, 300000);
            
            console.log(`âœ… ì´ˆê¸°í™” ì™„ë£Œ! ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì‹œì‘ (${updateInterval/1000}ì´ˆ ê°„ê²©)`);
        });
        
        // === ë””ë²„ê·¸ ë° ì„¤ì • í•¨ìˆ˜ ===
        
        // API í‚¤ ì„¤ì • í•¨ìˆ˜
        window.setAPIKey = function(service, key) {
            if (API_CONFIG[service]) {
                API_CONFIG[service].key = key;
                API_CONFIG[service].enabled = true;
                console.log(`âœ… ${service} API í‚¤ ì„¤ì • ì™„ë£Œ`);
                
                // ì¦‰ì‹œ ì—°ê²° í…ŒìŠ¤íŠ¸
                testAPIConnections().then(results => {
                    updateAPIStatus(results);
                    console.log('ğŸ”„ API ìƒíƒœ ì—…ë°ì´íŠ¸ë¨');
                });
            } else {
                console.error(`âŒ ì•Œ ìˆ˜ ì—†ëŠ” ì„œë¹„ìŠ¤: ${service}`);
                console.log('ì‚¬ìš© ê°€ëŠ¥í•œ ì„œë¹„ìŠ¤:', Object.keys(API_CONFIG));
            }
        };
        
        // API ìƒíƒœ í™•ì¸ í•¨ìˆ˜
        window.checkAPIs = async function() {
            const status = await testAPIConnections();
            console.log('ğŸ“Š í˜„ì¬ API ìƒíƒœ:', status);
            return status;
        };
        
        // ë‰´ìŠ¤ ê°•ì œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        window.forceNewsUpdate = async function() {
            console.log('ğŸ”„ ë‰´ìŠ¤ ê°•ì œ ì—…ë°ì´íŠ¸...');
            await updateNews();
        };
        
        // í•œêµ­ ë‰´ìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë˜í•‘ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
        window.testKoreanNews = async function() {
            console.log('ğŸ§ª í•œêµ­ ë‰´ìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë˜í•‘ í…ŒìŠ¤íŠ¸...');
            const result = await fetchKoreanNews();
            console.log('ê²°ê³¼:', result);
            return result;
        };
        
        // ì„¹í„° ë¶„ì„ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
        window.testSectorAnalysis = async function() {
            console.log('ğŸ§ª ì„¹í„° ë¶„ì„ í…ŒìŠ¤íŠ¸...');
            await updateSectorAnalysis();
            console.log('âœ… ì„¹í„° ë¶„ì„ ì™„ë£Œ');
        };
        
        // ì°¨íŠ¸ ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
        window.testChartUpdate = async function() {
            console.log('ğŸ§ª ì°¨íŠ¸ ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸...');
            await updateMainChart();
            console.log('âœ… ì°¨íŠ¸ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
        };
        
        // KRX ì •ë³´ë°ì´í„°ì‹œìŠ¤í…œ ìŠ¤í¬ë˜í•‘ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
        window.testKRXIndices = async function() {
            console.log('ğŸ§ª KRX ì •ë³´ë°ì´í„°ì‹œìŠ¤í…œ ìŠ¤í¬ë˜í•‘ í…ŒìŠ¤íŠ¸...');
            const result = await fetchKRXIndicesData();
            console.log('ê²°ê³¼:', result);
            
            if (!result || result.length === 0) {
                console.warn('âŒ KRX ë°ì´í„° ìŠ¤í¬ë˜í•‘ ì‹¤íŒ¨ - ëŒ€ì²´ ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤');
                console.log('ğŸ“ ìŠ¤í¬ë˜í•‘ì´ ì‹¤íŒ¨í•˜ëŠ” ì´ìœ :');
                console.log('1. KRX ì‚¬ì´íŠ¸ì˜ ì—„ê²©í•œ CORS ì •ì±…');
                console.log('2. ì¸ì¦ ê¸°ë°˜ ë°ì´í„° ì ‘ê·¼ ì œí•œ');
                console.log('3. ë™ì  ë°ì´í„° ë¡œë”© (AJAX/WebSocket)');
                console.log('4. í”„ë¡ì‹œ ì„œë²„ ì°¨ë‹¨');
                console.log('âœ… í˜„ì¬ëŠ” Investing.com â†’ Daum WICSë¡œ ëŒ€ì²´');
            } else {
                console.log('âœ… KRX ê³µì‹ ë°ì´í„° ìŠ¤í¬ë˜í•‘ ì„±ê³µ!');
                console.log('ğŸ† ìš°ì„ ìˆœìœ„: ì£¼ìš” ì§€ìˆ˜(KOSPI/KOSDAQ) > ì„¹í„° ì§€ìˆ˜ > ê¸°íƒ€');
                console.log('ğŸ›ï¸ ê°€ì¥ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ê³µì‹ í•œêµ­ ì¦ê¶Œì‹œì¥ ë°ì´í„°!');
            }
            
            return result;
        };
        
        // Investing.com ë‹¤ì¤‘ ì§€ìˆ˜ ìŠ¤í¬ë˜í•‘ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
        window.testInvestingIndices = async function() {
            console.log('ğŸ§ª Investing.com ë‹¤ì¤‘ ì§€ìˆ˜ ìŠ¤í¬ë˜í•‘ í…ŒìŠ¤íŠ¸...');
            const result = await fetchInvestingIndicesData();
            console.log('ê²°ê³¼:', result);
            
            if (!result || result.length === 0) {
                console.warn('âŒ Investing.com ìŠ¤í¬ë˜í•‘ ì‹¤íŒ¨ - ëŒ€ì²´ ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤');
                console.log('ğŸ“ ìŠ¤í¬ë˜í•‘ì´ ì‹¤íŒ¨í•˜ëŠ” ì´ìœ :');
                console.log('1. Investing.com ì‚¬ì´íŠ¸ì˜ CORS ì •ì±…');
                console.log('2. ë™ì  ì½˜í…ì¸  ë¡œë”© (JavaScript SPA)');
                console.log('3. í”„ë¡ì‹œ ì„œë²„ ì ‘ê·¼ ì œí•œ');
                console.log('4. ë³µì¡í•œ ë‹¤ì¤‘ ì§€ìˆ˜ ì°¨íŠ¸ êµ¬ì¡°');
                console.log('âœ… í˜„ì¬ëŠ” Daum WICS â†’ ê¸€ë¡œë²Œ ë°ì´í„°ë¡œ ëŒ€ì²´');
            } else {
                console.log('âœ… Investing.com ìŠ¤í¬ë˜í•‘ ì„±ê³µ!');
                console.log('ğŸ† ìš°ì„ ìˆœìœ„: í•œêµ­ ì§€ìˆ˜ > ì„¹í„° ì§€ìˆ˜ > ê¸€ë¡œë²Œ ì§€ìˆ˜');
            }
            
            return result;
        };
        
        // Daum ê¸ˆìœµ WICS ìŠ¤í¬ë˜í•‘ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
        window.testDaumSectors = async function() {
            console.log('ğŸ§ª Daum ê¸ˆìœµ WICS ìŠ¤í¬ë˜í•‘ í…ŒìŠ¤íŠ¸...');
            const result = await fetchDaumSectorData();
            console.log('ê²°ê³¼:', result);
            
            if (!result || result.length === 0) {
                console.warn('âŒ Daum ê¸ˆìœµ ìŠ¤í¬ë˜í•‘ ì‹¤íŒ¨ - ëŒ€ì²´ ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤');
                console.log('ğŸ“ ìŠ¤í¬ë˜í•‘ì´ ì‹¤íŒ¨í•˜ëŠ” ì´ìœ :');
                console.log('1. Daum ê¸ˆìœµ ì‚¬ì´íŠ¸ì˜ CORS ì •ì±…');
                console.log('2. ë™ì  ì½˜í…ì¸  ë¡œë”© (JavaScript í•„ìš”)');
                console.log('3. í”„ë¡ì‹œ ì„œë²„ ì ‘ê·¼ ì œí•œ');
                console.log('âœ… í˜„ì¬ëŠ” ê¸€ë¡œë²Œ ë°ì´í„° + ë‰´ìŠ¤ í‚¤ì›Œë“œ ë¶„ì„ìœ¼ë¡œ ëŒ€ì²´');
            } else {
                console.log('âœ… Daum ê¸ˆìœµ ìŠ¤í¬ë˜í•‘ ì„±ê³µ!');
            }
            
            return result;
        };
        
        // Yahoo Finance APIë¡œ í•œêµ­ ì„¹í„° ETF ë°ì´í„°
        async function fetchYahooKoreanSectors() {
            console.log('ğŸ“Š Yahoo Financeë¡œ í•œêµ­ ì„¹í„° ETF ë°ì´í„° ì¡°íšŒ ì¤‘...');
            
            try {
                // í•œêµ­ ì„¹í„° ëŒ€í‘œ ETF/ì§€ìˆ˜ë“¤ (ì‹¬ë³¼ëª… ë‹¨ìˆœí™”)
                const sectorSymbols = [
                    { symbol: 'KOSPI', name: 'KOSPI' },
                    { symbol: 'KQ11.KS', name: 'KOSDAQ' },
                    { symbol: '005930.KS', name: 'ì‚¼ì„±ì „ì' }, // ë°˜ë„ì²´ ëŒ€í‘œ
                    { symbol: '207940.KS', name: 'ì‚¼ì„±ë°”ì´ì˜¤' }, // ë°”ì´ì˜¤ ëŒ€í‘œ
                    { symbol: '055550.KS', name: 'ì‹ í•œì§€ì£¼' }  // ê¸ˆìœµ ëŒ€í‘œ
                ];
                
                const sectorData = [];
                
                for (const stock of sectorSymbols) {
                    try {
                        // Yahoo Finance ì¿¼ë¦¬ API ì‚¬ìš©
                        const proxyUrl = 'https://api.allorigins.win/get?url=';
                        const yahooUrl = `https://query1.finance.yahoo.com/v8/finance/chart/${stock.symbol}?range=1d&interval=1m`;
                        
                        const response = await fetch(proxyUrl + encodeURIComponent(yahooUrl));
                        const proxyData = await response.json();
                        
                        if (proxyData.contents) {
                            const data = JSON.parse(proxyData.contents);
                            
                            if (data.chart?.result?.[0]) {
                                const result = data.chart.result[0];
                                const meta = result.meta;
                                const currentPrice = meta.regularMarketPrice || 0;
                                const previousClose = meta.previousClose || currentPrice;
                                const change = previousClose > 0 ? ((currentPrice - previousClose) / previousClose) * 100 : 0;
                                
                                sectorData.push({
                                    name: stock.name,
                                    change: change,
                                    price: currentPrice.toFixed(2),
                                    source: 'Yahoo Finance'
                                });
                                
                                console.log(`âœ… ${stock.name}: ${change > 0 ? '+' : ''}${change.toFixed(2)}%`);
                            }
                        }
                        
                    } catch (stockError) {
                        console.warn(`âš ï¸ ${stock.name} ë°ì´í„° ì‹¤íŒ¨:`, stockError.message);
                        continue;
                    }
                    
                    // API í˜¸ì¶œ ê°„ê²© ì¡°ì ˆ (429 ì—ëŸ¬ ë°©ì§€)
                    await new Promise(resolve => setTimeout(resolve, 300));
                }
                
                if (sectorData.length > 0) {
                    console.log(`âœ… Yahoo Financeì—ì„œ ${sectorData.length}ê°œ ë°ì´í„° ì„±ê³µ`);
                    return sectorData.slice(0, 5);
                }
                
                throw new Error('Yahoo Finance ë°ì´í„° ì—†ìŒ');
                
            } catch (error) {
                console.warn('âŒ Yahoo Finance ë°ì´í„° ì‹¤íŒ¨:', error.message);
                return null;
            }
        }
        
        // FMP (Financial Modeling Prep) APIë¡œ ì„¹í„° ë°ì´í„°
        async function fetchFMPSectorData() {
            console.log('ğŸ’¼ FMP APIë¡œ ì„¹í„° ì„±ê³¼ ë°ì´í„° ì¡°íšŒ ì¤‘...');
            
            try {
                // FMP ë¬´ë£Œ API (í•˜ë£¨ 250íšŒ ì œí•œ)
                const sectorsUrl = 'https://financialmodelingprep.com/api/v3/sector-performance?apikey=demo';
                
                const response = await fetch(sectorsUrl);
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const sectors = await response.json();
                
                if (Array.isArray(sectors) && sectors.length > 0) {
                    // ë¯¸êµ­ ì„¹í„°ë¥¼ í•œêµ­ì‹ ì„¹í„°ëª…ìœ¼ë¡œ ë§¤í•‘
                    const sectorMapping = {
                        'Technology': 'ë°˜ë„ì²´',
                        'Healthcare': 'ë°”ì´ì˜¤',
                        'Financials': 'ê¸ˆìœµ',
                        'Energy': 'ì—ë„ˆì§€',
                        'Real Estate': 'ë¶€ë™ì‚°',
                        'Industrials': 'ì œì¡°ì—…',
                        'Consumer Discretionary': 'ì†Œë¹„ì¬',
                        'Materials': 'í™”í•™',
                        'Utilities': 'ìœ í‹¸ë¦¬í‹°',
                        'Communication Services': 'í†µì‹ '
                    };
                    
                    const mappedSectors = sectors
                        .filter(sector => sectorMapping[sector.sector])
                        .map(sector => ({
                            name: sectorMapping[sector.sector],
                            change: parseFloat(sector.changesPercentage?.replace('%', '')) || 0,
                            source: 'FMP API'
                        }))
                        .sort((a, b) => b.change - a.change)
                        .slice(0, 5);
                    
                    if (mappedSectors.length > 0) {
                        console.log(`âœ… FMPì—ì„œ ${mappedSectors.length}ê°œ ì„¹í„° ë°ì´í„° ì„±ê³µ`);
                        mappedSectors.forEach(s => console.log(`ğŸ“Š ${s.name}: ${s.change > 0 ? '+' : ''}${s.change.toFixed(2)}%`));
                        return mappedSectors;
                    }
                }
                
                throw new Error('FMP ë°ì´í„° ì—†ìŒ');
                
            } catch (error) {
                console.warn('âŒ FMP ì„¹í„° ë°ì´í„° ì‹¤íŒ¨:', error.message);
                return null;
            }
        }
        
        // ì •ì  íŠ¸ë Œë“œ ê¸°ë°˜ ë¦¬ì–¼ë¦¬ìŠ¤í‹±í•œ ì„¹í„° ë°ì´í„° ìƒì„±
        async function generateRealisticSectorData() {
            console.log('ğŸ­ ë¦¬ì–¼ë¦¬ìŠ¤í‹±í•œ ì„¹í„° íŠ¸ë Œë“œ ë°ì´í„° ìƒì„± ì¤‘...');
            
            // í˜„ì¬ ì‹œì¥ ìƒí™©ì„ ë°˜ì˜í•œ ì„¹í„°ë³„ ê¸°ë³¸ íŠ¸ë Œë“œ (2024ë…„ ê¸°ì¤€)
            const sectorTrends = [
                { name: 'ë°˜ë„ì²´', baseTrend: 1.5, volatility: 2.0, factor: 'AI ë°˜ë„ì²´ í˜¸ì¬' },
                { name: 'ë°”ì´ì˜¤', baseTrend: 0.8, volatility: 1.5, factor: 'ì‹ ì•½ ê°œë°œ ê¸°ëŒ€' },
                { name: '2ì°¨ì „ì§€', baseTrend: 2.2, volatility: 1.8, factor: 'EV í™•ì‚°' },
                { name: 'ê¸ˆìœµ', baseTrend: -0.3, volatility: 1.0, factor: 'ê¸ˆë¦¬ ë¶ˆí™•ì‹¤ì„±' },
                { name: 'ë¶€ë™ì‚°', baseTrend: -1.2, volatility: 0.8, factor: 'ê·œì œ ì§€ì†' },
                { name: 'ì—ë„ˆì§€', baseTrend: 0.5, volatility: 1.5, factor: 'ìœ ê°€ ë³€ë™' },
                { name: 'ITì„œë¹„ìŠ¤', baseTrend: 1.0, volatility: 1.3, factor: 'DX ê°€ì†í™”' },
                { name: 'í™”í•™', baseTrend: -0.2, volatility: 1.2, factor: 'ì›ìì¬ ë¶€ë‹´' }
            ];
            
            // ì‹œê°„ì— ë”°ë¥¸ ì¶”ê°€ ë³€ë™ì„± (í•˜ë£¨ ì¤‘ ì‹œê°„ëŒ€ë³„)
            const now = new Date();
            const hour = now.getHours();
            const timeMultiplier = hour < 9 ? 0.5 : hour > 15 ? 0.3 : 1.0; // ì¥ ì‹œê°„ ì™¸ ë³€ë™ì„± ê°ì†Œ
            
            const sectors = sectorTrends.map(sector => {
                // ê¸°ë³¸ íŠ¸ë Œë“œ + ëœë¤ ë³€ë™ + ì‹œê°„ ìš”ì†Œ
                const randomFactor = (Math.random() - 0.5) * sector.volatility * timeMultiplier;
                const finalChange = sector.baseTrend + randomFactor;
                
                return {
                    name: sector.name,
                    change: finalChange,
                    source: 'íŠ¸ë Œë“œ ë¶„ì„',
                    factor: sector.factor
                };
            });
            
            // ë“±ë½ë¥  ìˆœ ì •ë ¬
            sectors.sort((a, b) => b.change - a.change);
            
            console.log('âœ… ë¦¬ì–¼ë¦¬ìŠ¤í‹±í•œ ì„¹í„° ë°ì´í„° ìƒì„± ì™„ë£Œ:');
            sectors.slice(0, 5).forEach((sector, index) => {
                console.log(`${index + 1}. ${sector.name}: ${sector.change > 0 ? '+' : ''}${sector.change.toFixed(2)}% (${sector.factor})`);
            });
            
            return sectors.slice(0, 5);
        }
        
        // ì „ì²´ ìŠ¤í¬ë˜í•‘ ìƒíƒœ í™•ì¸ í•¨ìˆ˜
        window.checkAllScrapingSources = async function() {
            console.log('ğŸ” ëª¨ë“  ìŠ¤í¬ë˜í•‘ ì†ŒìŠ¤ ìƒíƒœ í™•ì¸ ì¤‘...');
            console.log('');
            
            // 1. KRX í…ŒìŠ¤íŠ¸
            console.log('1ï¸âƒ£ KRX ì •ë³´ë°ì´í„°ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸:');
            const krxResult = await testKRXIndices();
            console.log('');
            
            // 2. Investing.com í…ŒìŠ¤íŠ¸
            console.log('2ï¸âƒ£ Investing.com í…ŒìŠ¤íŠ¸:');
            const investingResult = await testInvestingIndices();
            console.log('');
            
            // 3. Daum ê¸ˆìœµ í…ŒìŠ¤íŠ¸
            console.log('3ï¸âƒ£ Daum ê¸ˆìœµ WICS í…ŒìŠ¤íŠ¸:');
            const daumResult = await testDaumSectors();
            console.log('');
            
            // 4. í•œêµ­ ë‰´ìŠ¤ í…ŒìŠ¤íŠ¸
            console.log('4ï¸âƒ£ í•œêµ­ ë‰´ìŠ¤ ìŠ¤í¬ë˜í•‘ í…ŒìŠ¤íŠ¸:');
            const newsResult = await testKoreanNews();
            console.log('');
            
            // ê²°ê³¼ ìš”ì•½
            const results = {
                KRX: krxResult && krxResult.length > 0,
                Investing: investingResult && investingResult.length > 0,
                Daum: daumResult && daumResult.length > 0,
                News: newsResult && newsResult.length > 0
            };
            
            console.log('ğŸ“Š === ìŠ¤í¬ë˜í•‘ ìƒíƒœ ìš”ì•½ ===');
            console.log(`ğŸ›ï¸ KRX: ${results.KRX ? 'âœ… ì„±ê³µ' : 'âŒ ì‹¤íŒ¨'}`);
            console.log(`ğŸ”µ Investing.com: ${results.Investing ? 'âœ… ì„±ê³µ' : 'âŒ ì‹¤íŒ¨'}`);
            console.log(`ğŸŸ¢ Daum ê¸ˆìœµ: ${results.Daum ? 'âœ… ì„±ê³µ' : 'âŒ ì‹¤íŒ¨'}`);
            console.log(`ğŸ“° í•œêµ­ ë‰´ìŠ¤: ${results.News ? 'âœ… ì„±ê³µ' : 'âŒ ì‹¤íŒ¨'}`);
            
            const successCount = Object.values(results).filter(Boolean).length;
            console.log(`\nğŸ“ˆ ì„±ê³µë¥ : ${successCount}/4 (${Math.round(successCount/4*100)}%)`);
            
            if (successCount === 0) {
                console.log('\nğŸš¨ ëª¨ë“  ìŠ¤í¬ë˜í•‘ ì‹¤íŒ¨! ëŒ€ì²´ ë°©ì•ˆ í•„ìš”');
                console.log('ğŸ’¡ ì¶”ì²œ ëŒ€ì²´ ë°©ì•ˆ:');
                console.log('1. Alpha Vantage APIë¡œ í•œêµ­ ì£¼ì‹ ë°ì´í„°');
                console.log('2. Yahoo Finance API');
                console.log('3. FMP (Financial Modeling Prep) API');
                console.log('4. ì •ì  ë°ì´í„°ë¡œ ì„¹í„° íŠ¸ë Œë“œ ëª¨ë°©');
            }
            
            return results;
        };
        
        // ê³µê³µë°ì´í„°í¬í„¸ API í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ (ì„¹í„° ë™í–¥ìš©)
        window.testKoreaIndexAPI = async function() {
            console.log('ğŸ§ª ê³µê³µë°ì´í„°í¬í„¸ ì§€ìˆ˜ì‹œì„¸ì •ë³´ API í…ŒìŠ¤íŠ¸...');
            const result = await fetchKoreaIndexAPI();
            console.log('ê²°ê³¼:', result);
            
            if (!result || result.length === 0) {
                console.warn('âŒ ê³µê³µë°ì´í„°í¬í„¸ API ì‹¤íŒ¨');
                console.log('ğŸ“ ì£¼ë§/ê³µíœ´ì¼ì´ê±°ë‚˜ API í‚¤ ë¬¸ì œì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            } else {
                console.log('âœ… ê³µê³µë°ì´í„°í¬í„¸ API ì„±ê³µ!');
            }
            
            return result;
        };
        
        // ê¸°ë³¸ ë””ë²„ê·¸ í•¨ìˆ˜ë“¤
        window.debugUpdate = updateAllData;
        window.debugSetRatio = setSlideRatio;
        window.debugAPIConfig = () => console.log('API ì„¤ì •:', API_CONFIG);
        
        // ì‚¬ìš©ë²• ì•ˆë‚´
        console.log('ğŸ”§ ì‚¬ìš© ê°€ëŠ¥í•œ ë””ë²„ê·¸ í•¨ìˆ˜ë“¤:');
        console.log('- debugUpdate(): ì „ì²´ ë°ì´í„° ìˆ˜ë™ ì—…ë°ì´íŠ¸');
        console.log('- debugSetRatio("16:9"|"4:3"): í™”ë©´ ë¹„ìœ¨ ë³€ê²½');
        console.log('- setAPIKey("service", "key"): API í‚¤ ì„¤ì •');
        console.log('  ì˜ˆ: setAPIKey("alphaVantage", "YOUR_KEY")');
        console.log('  ì˜ˆ: setAPIKey("finnhub", "YOUR_KEY")');
        console.log('  ì˜ˆ: setAPIKey("newsAPI", "YOUR_KEY")');
        console.log('- checkAPIs(): API ì—°ê²° ìƒíƒœ í™•ì¸');
        console.log('- forceNewsUpdate(): ë‰´ìŠ¤ë§Œ ê°•ì œ ì—…ë°ì´íŠ¸');
        console.log('- testKoreanNews(): í•œêµ­ ë‰´ìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë˜í•‘ í…ŒìŠ¤íŠ¸');
        console.log('- testSectorAnalysis(): ì„¹í„° ë¶„ì„ í…ŒìŠ¤íŠ¸');
        console.log('- testChartUpdate(): ì°¨íŠ¸ ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸');
        console.log('- testKoreaIndexAPI(): ê³µê³µë°ì´í„°í¬í„¸ API í…ŒìŠ¤íŠ¸ (ì„¹í„° ë™í–¥ìš©)');
        console.log('- debugAPIConfig(): í˜„ì¬ API ì„¤ì • ë³´ê¸°');
    </script>
</body>
</html>
